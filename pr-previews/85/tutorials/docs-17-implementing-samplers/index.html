<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Implementing samplers – Turing.jl</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../tutorials/docs-07-for-developers-variational-inference/index.html" rel="prev">
<link href="../../assets/favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-2486e1f0a3ee9ee1fc393803a1361cdb.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-6561bbde787c299e21493071c8edc6ff.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-67f38b0742f9bce76ffb8d9491dae701.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<style>
  a {
    text-decoration: none;
  }
  a:hover {
    text-decoration: underline;
  }
</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../theming/styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="https://turinglang.org/" class="navbar-brand navbar-brand-logo">
    <img src="../../assets/images/turing-logo.svg" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="https://turinglang.org/">
    <span class="navbar-title">Turing.jl</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials/docs-00-getting-started/"> 
<span class="menu-text">Get Started</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials/00-introduction/"> 
<span class="menu-text">Tutorials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/library/"> 
<span class="menu-text">Libraries</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/news/"> 
<span class="menu-text">News</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://turinglang.org/team/"> 
<span class="menu-text">Team</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-v0.34" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">v0.34</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-v0.34">    
        <li>
    <a class="dropdown-item" href="https://turinglang.org/docs/changelog.html">
 <span class="dropdown-text">Changelog</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="https://turinglang.org/docs/versions.html">
 <span class="dropdown-text">All Versions</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <a href="https://x.com/TuringLang" title="Turing Twitter" class="quarto-navigation-tool px-1" aria-label="Turing Twitter"><i class="bi bi-twitter"></i></a>
    <a href="https://github.com/TuringLang/Turing.jl" title="Turing GitHub" class="quarto-navigation-tool px-1" aria-label="Turing GitHub"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Developers</li><li class="breadcrumb-item"><a href="../../tutorials/docs-06-for-developers-interface/index.html">Inference (note: outdated)</a></li><li class="breadcrumb-item"><a href="../../tutorials/docs-17-implementing-samplers/index.html">Implementing Samplers</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Users</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-00-getting-started/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting Started</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-12-using-turing-guide/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Core Functionality</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Usage Tips</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-10-using-turing-autodiff/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Automatic Differentiation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/usage-custom-distribution/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Custom Distributions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/usage-probability-interface/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Querying Model Probabilities</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/usage-modifying-logprob/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modifying the Log Probability</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/usage-generated-quantities/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Generated Quantities</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-17-mode-estimation/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mode Estimation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-13-using-turing-performance-tips/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Performance Tips</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-15-using-turing-sampler-viz/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sampler Visualization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-11-using-turing-dynamichmc/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using DynamicHMC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-16-using-turing-external-samplers/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using External Samplers</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Tutorials</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/00-introduction/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction: Coin Flipping</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/01-gaussian-mixture-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gaussian Mixture Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/02-logistic-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/03-bayesian-neural-network/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Neural Networks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/04-hidden-markov-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hidden Markov Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/05-linear-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/06-infinite-mixture-model/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Infinite Mixture Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/07-poisson-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Poisson Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/08-multinomial-logistic-regression/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multinomial Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/09-variational-inference/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variational Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/10-bayesian-differential-equations/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Differential Equations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/11-probabilistic-pca/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Probabilistic PCA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/13-seasonal-time-series/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Time Series Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/15-gaussian-processes/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Gaussian Processes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/12-gplvm/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gaussian Process Latent Variable Models</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Developers</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Contributing</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-01-contributing-guide/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How to Contribute</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false">
 <span class="menu-text">DynamicPPL in Depth</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/dev-model-manual/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Manually Defining a Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-05-for-developers-compiler/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Turing Compiler Design</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/14-minituring/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A Mini Turing Implementation I: Compiler</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/16-contexts/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A Mini Turing Implementation II: Contexts</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Inference (note: outdated)</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-06-for-developers-interface/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interface Guide</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-04-for-developers-abstractmcmc-turing/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How Turing implements AbstractMCMC</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-07-for-developers-variational-inference/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Variational Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../tutorials/docs-17-implementing-samplers/index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Implementing Samplers</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of Contents</h2>
   
  <ul>
  <li><a href="#quick-overview-of-mala" id="toc-quick-overview-of-mala" class="nav-link active" data-scroll-target="#quick-overview-of-mala">Quick overview of MALA</a></li>
  <li><a href="#what-we-need-from-a-model-logdensityproblems.jl" id="toc-what-we-need-from-a-model-logdensityproblems.jl" class="nav-link" data-scroll-target="#what-we-need-from-a-model-logdensityproblems.jl">What we need from a model: LogDensityProblems.jl</a></li>
  <li><a href="#implementing-mala-in-abstractmcmc.jl" id="toc-implementing-mala-in-abstractmcmc.jl" class="nav-link" data-scroll-target="#implementing-mala-in-abstractmcmc.jl">Implementing MALA in AbstractMCMC.jl</a></li>
  <li><a href="#using-our-sampler-with-turing.jl" id="toc-using-our-sampler-with-turing.jl" class="nav-link" data-scroll-target="#using-our-sampler-with-turing.jl">Using our sampler with Turing.jl</a>
  <ul class="collapse">
  <li><a href="#models-with-constrained-parameters" id="toc-models-with-constrained-parameters" class="nav-link" data-scroll-target="#models-with-constrained-parameters">Models with constrained parameters</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/TuringLang/docs/edit/master/tutorials/docs-17-implementing-samplers/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/TuringLang/docs/issues/new" target="_blank" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Developers</li><li class="breadcrumb-item"><a href="../../tutorials/docs-06-for-developers-interface/index.html">Inference (note: outdated)</a></li><li class="breadcrumb-item"><a href="../../tutorials/docs-17-implementing-samplers/index.html">Implementing Samplers</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Implementing samplers</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this tutorial, we’ll go through step-by-step how to implement a “simple” sampler in <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> in such a way that it can be easily applied to Turing.jl models.</p>
<p>In particular, we’re going to implement a version of <strong>Metropolis-adjusted Langevin (MALA)</strong>.</p>
<p>Note that we will implement this sampler in the <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> framework, completely “ignoring” Turing.jl until the very end of the tutorial, at which point we’ll use a single line of code to make the resulting sampler available to Turing.jl. This is to really drive home the point that one can implement samplers in a way that is accessible to all of Turing.jl’s users without having to use Turing.jl yourself.</p>
<section id="quick-overview-of-mala" class="level2">
<h2 class="anchored" data-anchor-id="quick-overview-of-mala">Quick overview of MALA</h2>
<p>We can view MALA as a single step of the leapfrog intergrator with resampling of momentum <span class="math inline">\(p\)</span> at every step.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> To make that statement a bit more concrete, we first define the <em>extended</em> target <span class="math inline">\(\bar{\gamma}(x, p)\)</span> as</p>
<p><span class="math display">\[\begin{equation*}
\log \bar{\gamma}(x, p) \propto \log \gamma(x) + \log \gamma_{\mathcal{N}(0, M)}(p)
\end{equation*}\]</span></p>
<p>where <span class="math inline">\(\gamma_{\mathcal{N}(0, M)}\)</span> denotes the density for a zero-centered Gaussian with covariance matrix <span class="math inline">\(M\)</span>. We then consider targeting this joint distribution over both <span class="math inline">\(x\)</span> and <span class="math inline">\(p\)</span> as follows. First we define the map</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  L_{\epsilon}: \quad &amp; \mathbb{R}^d \times \mathbb{R}^d \to \mathbb{R}^d \times \mathbb{R}^d \\
  &amp; (x, p) \mapsto (\tilde{x}, \tilde{p}) := L_{\epsilon}(x, p)
\end{split}
\end{equation*}\]</span></p>
<p>as</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  p_{1 / 2} &amp;:= p + \frac{\epsilon}{2} \nabla \log \gamma(x) \\
  \tilde{x} &amp;:= x + \epsilon M^{-1} p_{1 /2 } \\
  p_1 &amp;:= p_{1 / 2} + \frac{\epsilon}{2} \nabla \log \gamma(\tilde{x}) \\
  \tilde{p} &amp;:= - p_1
\end{split}
\end{equation*}\]</span></p>
<p>This might be familiar for some readers as a single step of the Leapfrog integrator. We then define the MALA kernel as follows: given the current iterate <span class="math inline">\(x_i\)</span>, we sample the next iterate <span class="math inline">\(x_{i + 1}\)</span> as</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
  p &amp;\sim \mathcal{N}(0, M) \\
  (\tilde{x}, \tilde{p}) &amp;:= L_{\epsilon}(x_i, p) \\
  \alpha &amp;:= \min \left\{ 1, \frac{\bar{\gamma}(\tilde{x}, \tilde{p})}{\bar{\gamma}(x_i, p)} \right\} \\
  x_{i + 1} &amp;:=
  \begin{cases}
    \tilde{x} \quad &amp; \text{ with prob. } \alpha \\
    x_i       \quad &amp; \text{ with prob. } 1 - \alpha
  \end{cases}
\end{split}
\end{equation*}\]</span></p>
<p>i.e.&nbsp;we accept the proposal <span class="math inline">\(\tilde{x}\)</span> with probability <span class="math inline">\(\alpha\)</span> and reject it, thus sticking with our current iterate, with probability <span class="math inline">\(1 - \alpha\)</span>.</p>
</section>
<section id="what-we-need-from-a-model-logdensityproblems.jl" class="level2">
<h2 class="anchored" data-anchor-id="what-we-need-from-a-model-logdensityproblems.jl">What we need from a model: <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a></h2>
<p>There are a few things we need from the “target” / “model” / density that we want to sample from:</p>
<ol type="1">
<li>We need access to log-density <em>evaluations</em> <span class="math inline">\(\log \gamma(x)\)</span> so we can compute the acceptance ratio involving <span class="math inline">\(\log \bar{\gamma}(x, p)\)</span>.</li>
<li>We need access to log-density <em>gradients</em> <span class="math inline">\(\nabla \log \gamma(x)\)</span> so we can compute the Leapfrog steps <span class="math inline">\(L_{\epsilon}(x, p)\)</span>.</li>
<li>We also need access to the “size” of the model so we can determine the size of <span class="math inline">\(M\)</span>.</li>
</ol>
<p>Luckily for us, there is a package called <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> which provides an interface for <em>exactly</em> this!</p>
<p>To demonstrate how one can implement the “<a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface”<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> we will use a simple Gaussian model as an example:</p>
<div id="4" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LogDensityProblems</span>: LogDensityProblems;</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's define some type that represents the model.</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> IsotropicNormalModel{M<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"mean of the isotropic Gaussian"</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    mean<span class="op">::</span><span class="dt">M</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Specifies what input length the model expects.</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">dimension</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> <span class="fu">length</span>(model.mean)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Implementation of the log-density evaluation of the model.</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> LogDensityProblems.<span class="fu">logdensity</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>, x<span class="op">::</span><span class="dt">AbstractVector{&lt;:Real}</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span> <span class="fu">sum</span>(abs2, x <span class="op">.-</span> model.mean) <span class="op">/</span> <span class="fl">2</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This gives us all of the properties we want for our MALA sampler with the exception of the computation of the <em>gradient</em> <span class="math inline">\(\nabla \log \gamma(x)\)</span>. There is the method <code>LogDensityProblems.logdensity_and_gradient</code> which should return a 2-tuple where the first entry is the evaluation of the logdensity <span class="math inline">\(\log \gamma(x)\)</span> and the second entry is the gradient <span class="math inline">\(\nabla \log \gamma(x)\)</span>.</p>
<p>There are two ways to “implement” this method: 1) we implement it by hand, which is feasible in the case of our <code>IsotropicNormalModel</code>, or b) we defer the implementation of this to a automatic differentiation backend.</p>
<p>To implement it by hand we can simply do</p>
<div id="6" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tell LogDensityProblems.jl that first-order, i.e. gradient information, is available.</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">capabilities</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> LogDensityProblems.<span class="fu">LogDensityOrder</span><span class="dt">{1}</span>()</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement `logdensity_and_gradient`.</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>, x)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    logγ_x <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x <span class="op">=</span> <span class="op">-</span>x <span class="op">.*</span> (x <span class="op">-</span> model.mean)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> logγ_x, ∇logγ_x</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s just try it out:</p>
<div id="8" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate the problem.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> <span class="fu">IsotropicNormalModel</span>([<span class="op">-</span><span class="fl">5</span>., <span class="fl">0</span>., <span class="fl">5</span>.])</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create some example input that we can test on.</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>x_example <span class="op">=</span> <span class="fu">randn</span>(LogDensityProblems.<span class="fu">dimension</span>(model))</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate!</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">logdensity</span>(model, x_example)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-37.115462698399384</code></pre>
</div>
</div>
<p>To defer it to an automatic differentiation backend, we can do</p>
<div id="10" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tell LogDensityProblems.jl we only have access to 0-th order information.</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">capabilities</span>(model<span class="op">::</span><span class="dt">IsotropicNormalModel</span>) <span class="op">=</span> LogDensityProblems.<span class="fu">LogDensityOrder</span><span class="dt">{0}</span>()</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Use `LogDensityProblemsAD`'s `ADgradient` in combination with some AD backend to implement `logdensity_and_gradient`.</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">LogDensityProblemsAD</span>, <span class="bu">ADTypes</span>, <span class="bu">ForwardDiff</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>model_with_grad <span class="op">=</span> <span class="fu">ADgradient</span>(<span class="fu">AutoForwardDiff</span>(), model)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>LogDensityProblems.<span class="fu">logdensity</span>(model_with_grad, x_example)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-37.115462698399384</code></pre>
</div>
</div>
<p>We’ll continue with the second approach in this tutorial since this is typically what one does in practice, because there are better hobbies to spend time on than deriving gradients by hand.</p>
<p>At this point, one might wonder how we’re going to tie this back to Turing.jl in the end. Effectively, when working with inference methods that only require log-density evaluations and / or higher-order information of the log-density, Turing.jl actually converts the user-provided <code>Model</code> into an object implementing the above methods for <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>. As a result, most samplers provided by Turing.jl are actually implemented to work with <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>, enabling their use both <em>within</em> Turing.jl and <em>outside</em> of Turing.jl! Morever, there exists similar conversions for Stan through BridgeStan and Stan<a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a>, which means that a sampler supporting the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface can easily be used on both Turing.jl <em>and</em> Stan models (in addition to user-provided models, as our <code>IsotropicNormalModel</code> above)!</p>
<p>Anyways, let’s move on to actually implementing the sampler.</p>
</section>
<section id="implementing-mala-in-abstractmcmc.jl" class="level2">
<h2 class="anchored" data-anchor-id="implementing-mala-in-abstractmcmc.jl">Implementing MALA in <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a></h2>
<p>Now that we’ve established that a model implementing the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface provides us with all the information we need from <span class="math inline">\(\log \gamma(x)\)</span>, we can address the question: given an object that implements the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface, how can we define a sampler for it?</p>
<p>We’re going to do this by making our sampler a sub-type of <code>AbstractMCMC.AbstractSampler</code> in addition to implementing a few methods from <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a>. Why? Because it gets us <em>a lot</em> of functionality for free, as we will see later.</p>
<p>Moreover, <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> provides a very natural interface for MCMC algorithms.</p>
<p>First, we’ll define our <code>MALA</code> type</p>
<div id="12" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">AbstractMCMC</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALA{T,A} <span class="op">&lt;:</span><span class="dt"> AbstractMCMC.AbstractSampler</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"stepsize used in the leapfrog step"</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    ϵ_init<span class="op">::</span><span class="dt">T</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"covariance matrix used for the momentum"</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    M_init<span class="op">::</span><span class="dt">A</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notice how we’ve added the suffix <code>_init</code> to both the stepsize and the covariance matrix. We’ve done this because a <code>AbstractMCMC.AbstractSampler</code> should be <em>immutable</em>. Of course there might be many scenarios where we want to allow something like the stepsize and / or the covariance matrix to vary between iterations, e.g.&nbsp;during the burn-in / adaptation phase of the sampling process we might want to adjust the parameters using statistics computed from these initial iterations. But information which can change between iterations <em>should not go in the sampler itself</em>! Instead, this information should go in the sampler <em>state</em>.</p>
<p>The sampler state should at the very least contain all the necessary information to perform the next MCMC iteration, but usually contains further information, e.g.&nbsp;quantities and statistics useful for evaluating whether the sampler has converged.</p>
<p>We will use the following sampler state for our <code>MALA</code> sampler:</p>
<div id="14" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALAState{A<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"current position"</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">::</span><span class="dt">A</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This might seem overly redundant: we’re defining a type <code>MALAState</code> and it only contains a simple vector of reals. In this particular case we indeed could have dropped this and simply used a <code>AbstractVector{&lt;:Real}</code> as our sampler state, but typically, as we will see later, one wants to include other quantities in the sampler state. For example, if we also wanted to adapt the parameters of our <code>MALA</code>, e.g.&nbsp;alter the stepsize depending on acceptance rates, in which case we should also put <code>ϵ</code> in the state, but for now we’ll keep things simple.</p>
<p>Moreover, we also want a <em>sample</em> type, which is a type meant for “public consumption”, i.e.&nbsp;the end-user. This is generally going to contain a subset of the information present in the state. But in such a simple scenario as this, we similarly only have a <code>AbstractVector{&lt;:Real}</code>:</p>
<div id="16" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MALASample{A<span class="op">&lt;:</span><span class="dt">AbstractVector{&lt;:Real}</span>}</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"current position"</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    x<span class="op">::</span><span class="dt">A</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We currently have three things:</p>
<ol type="1">
<li>A <code>AbstractMCMC.AbstractSampler</code> implementation called <code>MALA</code>.</li>
<li>A state <code>MALAState</code> for our sampler <code>MALA</code>.</li>
<li>A sample <code>MALASample</code> for our sampler <code>MALA</code>.</li>
</ol>
<p>That means that we’re ready to implement the only thing that really matters: <code>AbstractMCMC.step</code>.</p>
<p><code>AbstractMCMC.step</code> defines the MCMC iteration of our <code>MALA</code> given the current <code>MALAState</code>. Specifically, the signature of the function is as follows:</p>
<div id="18" class="cell" data-execution_count="0">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The RNG to ensure reproducibility.</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The model that defines our target.</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    model<span class="op">::</span><span class="dt">AbstractMCMC.AbstractModel</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The sampler for which we're taking a `step`.</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">AbstractMCMC.AbstractSampler</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The current sampler `state`.</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    state;</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Additional keyword arguments that we may or may not need.</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Moreover, there is a specific <code>AbstractMCMC.AbstractModel</code> which is used to indicate that the model that is provided implements the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface: <code>AbstractMCMC.LogDensityModel</code>.</p>
<p>Since, as we discussed earlier, in our case we’re indeed going to work with types that support the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface, we’ll define <code>AbstractMCMC.step</code> for such a <code>AbstractMCMC.LogDensityModel</code>.</p>
<p>Note that <code>AbstractMCMC.LogDensityModel</code> has no other purpose; it has a single field called <code>logdensity</code>, and it does nothing else. But by wrapping the model in <code>AbstractMCMC.LogDensityModel</code>, it allows samplers that want to work with <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> to define their <code>AbstractMCMC.step</code> on this type without running into method ambiguities.</p>
<p>All in all, that means that the signature for our <code>AbstractMCMC.step</code> is going to be the following:</p>
<div id="20" class="cell" data-execution_count="0">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># `LogDensityModel` so we know we're working with LogDensityProblems.jl model.</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    model<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Our sampler.</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">MALA</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Our sampler state.</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    state<span class="op">::</span><span class="dt">MALAState</span>;</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Great! Now let’s actually implement the full <code>AbstractMCMC.step</code> for our <code>MALA</code>.</p>
<p>Let’s remind ourselves what we’re going to do:</p>
<ol type="1">
<li>Sample a new momentum <span class="math inline">\(p\)</span>.</li>
<li>Compute the log-density of the extended target <span class="math inline">\(\log \bar{\gamma}(x, p)\)</span>.</li>
<li>Take a single leapfrog step <span class="math inline">\((\tilde{x}, \tilde{p}) = L_{\epsilon}(x, p)\)</span>.</li>
<li>Accept or reject the proposed <span class="math inline">\((\tilde{x}, \tilde{p})\)</span>.</li>
</ol>
<p>All in all, this results in the following:</p>
<div id="22" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span>: Random</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Distributions</span>  <span class="co"># so we get the `MvNormal`</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    model_wrapper<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    sampler<span class="op">::</span><span class="dt">MALA</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    state<span class="op">::</span><span class="dt">MALAState</span>;</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the wrapped model which implements LogDensityProblems.jl.</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> model_wrapper.logdensity</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Let's just extract the sampler parameters to make our lives easier.</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    ϵ <span class="op">=</span> sampler.ϵ_init</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    M <span class="op">=</span> sampler.M_init</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Extract the current parameters.</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> state.x</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sample the momentum.</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    p_dist <span class="op">=</span> <span class="fu">MvNormal</span>(<span class="fu">zeros</span>(LogDensityProblems.<span class="fu">dimension</span>(model)), M)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="fu">rand</span>(rng, p_dist)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Propose using a single leapfrog step.</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    x̃, p̃ <span class="op">=</span> <span class="fu">leapfrog_step</span>(model, x, p, ϵ, M)</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Accept or reject proposal.</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    logp <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x) <span class="op">+</span> <span class="fu">logpdf</span>(p_dist, p)</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    logp̃ <span class="op">=</span> LogDensityProblems.<span class="fu">logdensity</span>(model, x̃) <span class="op">+</span> <span class="fu">logpdf</span>(p_dist, p̃)</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    logα <span class="op">=</span> logp̃ <span class="op">-</span> logp</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    state_new <span class="op">=</span> <span class="cf">if</span> <span class="fu">log</span>(<span class="fu">rand</span>(rng)) <span class="op">&lt;</span> logα</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Accept.</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MALAState</span>(x̃)</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Reject.</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">MALAState</span>(x)</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Return the "sample" and the sampler state.</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">MALASample</span>(state_new.x), state_new</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fairly straight-forward.</p>
<p>Of course, we haven’t defined the <code>leapfrog_step</code> method yet, so let’s do that:</p>
<div id="24" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">leapfrog_step</span>(model, x, p, ϵ, M)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update momentum `p` using "position" `x`.</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x <span class="op">=</span> <span class="fu">last</span>(LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model, x))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    p1 <span class="op">=</span> p <span class="op">+</span> (ϵ <span class="op">/</span> <span class="fl">2</span>) <span class="op">.*</span> ∇logγ_x</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update the "position" `x` using momentum `p1`.</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    x̃ <span class="op">=</span> x <span class="op">+</span> ϵ <span class="op">.*</span> (M <span class="op">\</span> p1)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Update momentum `p1` using position `x̃`</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    ∇logγ_x̃ <span class="op">=</span> <span class="fu">last</span>(LogDensityProblems.<span class="fu">logdensity_and_gradient</span>(model, x̃))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    p2 <span class="op">=</span> p1 <span class="op">+</span> (ϵ <span class="op">/</span> <span class="fl">2</span>) <span class="op">.*</span> ∇logγ_x̃</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Flip momentum `p2`.</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    p̃ <span class="op">=</span> <span class="op">-</span>p2</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x̃, p̃</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>leapfrog_step (generic function with 1 method)</code></pre>
</div>
</div>
<p>With all of this, we’re technically ready to sample!</p>
<div id="26" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Random</span>, <span class="bu">LinearAlgebra</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> <span class="bu">Random</span>.<span class="fu">default_rng</span>()</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>sampler <span class="op">=</span> <span class="fu">MALA</span>(<span class="fl">1</span>, I)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>state <span class="op">=</span> <span class="fu">MALAState</span>(<span class="fu">zeros</span>(LogDensityProblems.<span class="fu">dimension</span>(model)))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>x_next, state_next <span class="op">=</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    rng,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    AbstractMCMC.<span class="fu">LogDensityModel</span>(model),</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    sampler,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    state</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>(MALASample{Vector{Float64}}([-1.5724133672220726, -0.31685152398588695, 0.9169271600888881]), MALAState{Vector{Float64}}([-1.5724133672220726, -0.31685152398588695, 0.9169271600888881]))</code></pre>
</div>
</div>
<p>Great, it works!</p>
<p>And I promised we would get quite some functionality for free if we implemented <code>AbstractMCMC.step</code>, and so we can now simply call <code>sample</code> to perform standard MCMC sampling:</p>
<div id="28" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform 1000 iterations with our `MALA` sampler.</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(model_with_grad, sampler, <span class="fl">10_000</span>; initial_state<span class="op">=</span>state, progress<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Concatenate into a matrix.</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>samples_matrix <span class="op">=</span> <span class="fu">stack</span>(sample <span class="op">-&gt;</span> sample.x, samples)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×10000 Matrix{Float64}:
 -2.69216   -4.33008   -3.70369   -4.98708  …  -3.15067   -3.68826  -3.48017
  0.514985  -0.606092  -0.517524   0.3973      -0.414682   1.44675  -0.266482
  3.31408    3.19803    3.14977    2.94178      5.30822    4.68034   5.55228</code></pre>
</div>
</div>
<div id="30" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the marginal means and standard deviations.</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hcat</span>(<span class="fu">mean</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">std</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×2 Matrix{Float64}:
 -4.97494     0.989619
  0.00637944  0.996825
  5.03575     0.994207</code></pre>
</div>
</div>
<p>Let’s visualize the samples</p>
<div id="32" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">StatsPlots</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">transpose</span>(samples_matrix[<span class="op">:</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">:</span><span class="kw">end</span>]), alpha<span class="op">=</span><span class="fl">0.5</span>, legend<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="672" height="480" viewbox="0 0 2688 1920">
<defs>
  <clippath id="clip140">
    <rect x="0" y="0" width="2688" height="1920"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip140)" d="M0 1920 L2688 1920 L2688 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip141">
    <rect x="537" y="0" width="1883" height="1883"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip140)" d="M196.816 1800.78 L2640.76 1800.78 L2640.76 47.2441 L196.816 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip142">
    <rect x="196" y="47" width="2445" height="1755"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="263.676,1800.78 263.676,47.2441 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="840.654,1800.78 840.654,47.2441 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1417.63,1800.78 1417.63,47.2441 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1994.61,1800.78 1994.61,47.2441 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2571.59,1800.78 2571.59,47.2441 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1615.44 2640.76,1615.44 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1368.66 2640.76,1368.66 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,1121.88 2640.76,1121.88 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,875.1 2640.76,875.1 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,628.322 2640.76,628.322 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,381.543 2640.76,381.543 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="196.816,134.765 2640.76,134.765 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1800.78 2640.76,1800.78 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="263.676,1800.78 263.676,1781.88 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="840.654,1800.78 840.654,1781.88 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1417.63,1800.78 1417.63,1781.88 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1994.61,1800.78 1994.61,1781.88 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2571.59,1800.78 2571.59,1781.88 "></polyline>
<path clip-path="url(#clip140)" d="M263.676 1834 Q260.065 1834 258.236 1837.57 Q256.431 1841.11 256.431 1848.24 Q256.431 1855.34 258.236 1858.91 Q260.065 1862.45 263.676 1862.45 Q267.31 1862.45 269.116 1858.91 Q270.945 1855.34 270.945 1848.24 Q270.945 1841.11 269.116 1837.57 Q267.31 1834 263.676 1834 M263.676 1830.3 Q269.486 1830.3 272.542 1834.9 Q275.621 1839.49 275.621 1848.24 Q275.621 1856.96 272.542 1861.57 Q269.486 1866.15 263.676 1866.15 Q257.866 1866.15 254.787 1861.57 Q251.732 1856.96 251.732 1848.24 Q251.732 1839.49 254.787 1834.9 Q257.866 1830.3 263.676 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M804.346 1861.55 L820.666 1861.55 L820.666 1865.48 L798.721 1865.48 L798.721 1861.55 Q801.383 1858.79 805.967 1854.16 Q810.573 1849.51 811.754 1848.17 Q813.999 1845.65 814.879 1843.91 Q815.782 1842.15 815.782 1840.46 Q815.782 1837.71 813.837 1835.97 Q811.916 1834.23 808.814 1834.23 Q806.615 1834.23 804.161 1835 Q801.731 1835.76 798.953 1837.31 L798.953 1832.59 Q801.777 1831.46 804.231 1830.88 Q806.684 1830.3 808.721 1830.3 Q814.092 1830.3 817.286 1832.98 Q820.481 1835.67 820.481 1840.16 Q820.481 1842.29 819.67 1844.21 Q818.883 1846.11 816.777 1848.7 Q816.198 1849.37 813.096 1852.59 Q809.995 1855.78 804.346 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M830.527 1830.92 L848.883 1830.92 L848.883 1834.86 L834.809 1834.86 L834.809 1843.33 Q835.828 1842.98 836.846 1842.82 Q837.865 1842.64 838.883 1842.64 Q844.67 1842.64 848.05 1845.81 Q851.43 1848.98 851.43 1854.4 Q851.43 1859.97 847.957 1863.08 Q844.485 1866.15 838.166 1866.15 Q835.99 1866.15 833.721 1865.78 Q831.476 1865.41 829.069 1864.67 L829.069 1859.97 Q831.152 1861.11 833.374 1861.66 Q835.596 1862.22 838.073 1862.22 Q842.078 1862.22 844.416 1860.11 Q846.754 1858.01 846.754 1854.4 Q846.754 1850.78 844.416 1848.68 Q842.078 1846.57 838.073 1846.57 Q836.198 1846.57 834.323 1846.99 Q832.471 1847.4 830.527 1848.28 L830.527 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M870.642 1834 Q867.031 1834 865.203 1837.57 Q863.397 1841.11 863.397 1848.24 Q863.397 1855.34 865.203 1858.91 Q867.031 1862.45 870.642 1862.45 Q874.277 1862.45 876.082 1858.91 Q877.911 1855.34 877.911 1848.24 Q877.911 1841.11 876.082 1837.57 Q874.277 1834 870.642 1834 M870.642 1830.3 Q876.453 1830.3 879.508 1834.9 Q882.587 1839.49 882.587 1848.24 Q882.587 1856.96 879.508 1861.57 Q876.453 1866.15 870.642 1866.15 Q864.832 1866.15 861.754 1861.57 Q858.698 1856.96 858.698 1848.24 Q858.698 1839.49 861.754 1834.9 Q864.832 1830.3 870.642 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1377.25 1830.92 L1395.61 1830.92 L1395.61 1834.86 L1381.53 1834.86 L1381.53 1843.33 Q1382.55 1842.98 1383.57 1842.82 Q1384.59 1842.64 1385.61 1842.64 Q1391.39 1842.64 1394.77 1845.81 Q1398.15 1848.98 1398.15 1854.4 Q1398.15 1859.97 1394.68 1863.08 Q1391.21 1866.15 1384.89 1866.15 Q1382.71 1866.15 1380.44 1865.78 Q1378.2 1865.41 1375.79 1864.67 L1375.79 1859.97 Q1377.88 1861.11 1380.1 1861.66 Q1382.32 1862.22 1384.8 1862.22 Q1388.8 1862.22 1391.14 1860.11 Q1393.48 1858.01 1393.48 1854.4 Q1393.48 1850.78 1391.14 1848.68 Q1388.8 1846.57 1384.8 1846.57 Q1382.92 1846.57 1381.05 1846.99 Q1379.19 1847.4 1377.25 1848.28 L1377.25 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1417.37 1834 Q1413.75 1834 1411.93 1837.57 Q1410.12 1841.11 1410.12 1848.24 Q1410.12 1855.34 1411.93 1858.91 Q1413.75 1862.45 1417.37 1862.45 Q1421 1862.45 1422.81 1858.91 Q1424.63 1855.34 1424.63 1848.24 Q1424.63 1841.11 1422.81 1837.57 Q1421 1834 1417.37 1834 M1417.37 1830.3 Q1423.18 1830.3 1426.23 1834.9 Q1429.31 1839.49 1429.31 1848.24 Q1429.31 1856.96 1426.23 1861.57 Q1423.18 1866.15 1417.37 1866.15 Q1411.56 1866.15 1408.48 1861.57 Q1405.42 1856.96 1405.42 1848.24 Q1405.42 1839.49 1408.48 1834.9 Q1411.56 1830.3 1417.37 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1447.53 1834 Q1443.92 1834 1442.09 1837.57 Q1440.28 1841.11 1440.28 1848.24 Q1440.28 1855.34 1442.09 1858.91 Q1443.92 1862.45 1447.53 1862.45 Q1451.16 1862.45 1452.97 1858.91 Q1454.8 1855.34 1454.8 1848.24 Q1454.8 1841.11 1452.97 1837.57 Q1451.16 1834 1447.53 1834 M1447.53 1830.3 Q1453.34 1830.3 1456.39 1834.9 Q1459.47 1839.49 1459.47 1848.24 Q1459.47 1856.96 1456.39 1861.57 Q1453.34 1866.15 1447.53 1866.15 Q1441.72 1866.15 1438.64 1861.57 Q1435.58 1856.96 1435.58 1848.24 Q1435.58 1839.49 1438.64 1834.9 Q1441.72 1830.3 1447.53 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1952.89 1830.92 L1975.11 1830.92 L1975.11 1832.91 L1962.56 1865.48 L1957.68 1865.48 L1969.48 1834.86 L1952.89 1834.86 L1952.89 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M1984.27 1830.92 L2002.63 1830.92 L2002.63 1834.86 L1988.56 1834.86 L1988.56 1843.33 Q1989.58 1842.98 1990.59 1842.82 Q1991.61 1842.64 1992.63 1842.64 Q1998.42 1842.64 2001.8 1845.81 Q2005.18 1848.98 2005.18 1854.4 Q2005.18 1859.97 2001.7 1863.08 Q1998.23 1866.15 1991.91 1866.15 Q1989.74 1866.15 1987.47 1865.78 Q1985.22 1865.41 1982.82 1864.67 L1982.82 1859.97 Q1984.9 1861.11 1987.12 1861.66 Q1989.34 1862.22 1991.82 1862.22 Q1995.83 1862.22 1998.16 1860.11 Q2000.5 1858.01 2000.5 1854.4 Q2000.5 1850.78 1998.16 1848.68 Q1995.83 1846.57 1991.82 1846.57 Q1989.95 1846.57 1988.07 1846.99 Q1986.22 1847.4 1984.27 1848.28 L1984.27 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M2024.39 1834 Q2020.78 1834 2018.95 1837.57 Q2017.14 1841.11 2017.14 1848.24 Q2017.14 1855.34 2018.95 1858.91 Q2020.78 1862.45 2024.39 1862.45 Q2028.02 1862.45 2029.83 1858.91 Q2031.66 1855.34 2031.66 1848.24 Q2031.66 1841.11 2029.83 1837.57 Q2028.02 1834 2024.39 1834 M2024.39 1830.3 Q2030.2 1830.3 2033.26 1834.9 Q2036.33 1839.49 2036.33 1848.24 Q2036.33 1856.96 2033.26 1861.57 Q2030.2 1866.15 2024.39 1866.15 Q2018.58 1866.15 2015.5 1861.57 Q2012.45 1856.96 2012.45 1848.24 Q2012.45 1839.49 2015.5 1834.9 Q2018.58 1830.3 2024.39 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M2516.11 1861.55 L2523.75 1861.55 L2523.75 1835.18 L2515.44 1836.85 L2515.44 1832.59 L2523.71 1830.92 L2528.38 1830.92 L2528.38 1861.55 L2536.02 1861.55 L2536.02 1865.48 L2516.11 1865.48 L2516.11 1861.55 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M2555.47 1834 Q2551.85 1834 2550.03 1837.57 Q2548.22 1841.11 2548.22 1848.24 Q2548.22 1855.34 2550.03 1858.91 Q2551.85 1862.45 2555.47 1862.45 Q2559.1 1862.45 2560.9 1858.91 Q2562.73 1855.34 2562.73 1848.24 Q2562.73 1841.11 2560.9 1837.57 Q2559.1 1834 2555.47 1834 M2555.47 1830.3 Q2561.28 1830.3 2564.33 1834.9 Q2567.41 1839.49 2567.41 1848.24 Q2567.41 1856.96 2564.33 1861.57 Q2561.28 1866.15 2555.47 1866.15 Q2549.66 1866.15 2546.58 1861.57 Q2543.52 1856.96 2543.52 1848.24 Q2543.52 1839.49 2546.58 1834.9 Q2549.66 1830.3 2555.47 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M2585.63 1834 Q2582.02 1834 2580.19 1837.57 Q2578.38 1841.11 2578.38 1848.24 Q2578.38 1855.34 2580.19 1858.91 Q2582.02 1862.45 2585.63 1862.45 Q2589.26 1862.45 2591.07 1858.91 Q2592.9 1855.34 2592.9 1848.24 Q2592.9 1841.11 2591.07 1837.57 Q2589.26 1834 2585.63 1834 M2585.63 1830.3 Q2591.44 1830.3 2594.49 1834.9 Q2597.57 1839.49 2597.57 1848.24 Q2597.57 1856.96 2594.49 1861.57 Q2591.44 1866.15 2585.63 1866.15 Q2579.82 1866.15 2576.74 1861.57 Q2573.68 1856.96 2573.68 1848.24 Q2573.68 1839.49 2576.74 1834.9 Q2579.82 1830.3 2585.63 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M2615.79 1834 Q2612.18 1834 2610.35 1837.57 Q2608.54 1841.11 2608.54 1848.24 Q2608.54 1855.34 2610.35 1858.91 Q2612.18 1862.45 2615.79 1862.45 Q2619.42 1862.45 2621.23 1858.91 Q2623.06 1855.34 2623.06 1848.24 Q2623.06 1841.11 2621.23 1837.57 Q2619.42 1834 2615.79 1834 M2615.79 1830.3 Q2621.6 1830.3 2624.65 1834.9 Q2627.73 1839.49 2627.73 1848.24 Q2627.73 1856.96 2624.65 1861.57 Q2621.6 1866.15 2615.79 1866.15 Q2609.98 1866.15 2606.9 1861.57 Q2603.84 1856.96 2603.84 1848.24 Q2603.84 1839.49 2606.9 1834.9 Q2609.98 1830.3 2615.79 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1800.78 196.816,47.2441 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1615.44 215.714,1615.44 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1368.66 215.714,1368.66 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,1121.88 215.714,1121.88 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,875.1 215.714,875.1 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,628.322 215.714,628.322 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,381.543 215.714,381.543 "></polyline>
<polyline clip-path="url(#clip140)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="196.816,134.765 215.714,134.765 "></polyline>
<path clip-path="url(#clip140)" d="M50.5475 1615.89 L80.2233 1615.89 L80.2233 1619.82 L50.5475 1619.82 L50.5475 1615.89 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M89.1352 1598.16 L111.357 1598.16 L111.357 1600.15 L98.8111 1632.72 L93.9269 1632.72 L105.732 1602.09 L89.1352 1602.09 L89.1352 1598.16 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M120.478 1626.84 L125.362 1626.84 L125.362 1632.72 L120.478 1632.72 L120.478 1626.84 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M135.593 1598.16 L153.95 1598.16 L153.95 1602.09 L139.876 1602.09 L139.876 1610.56 Q140.894 1610.22 141.913 1610.05 Q142.931 1609.87 143.95 1609.87 Q149.737 1609.87 153.116 1613.04 Q156.496 1616.21 156.496 1621.63 Q156.496 1627.21 153.024 1630.31 Q149.552 1633.39 143.232 1633.39 Q141.056 1633.39 138.788 1633.02 Q136.542 1632.65 134.135 1631.91 L134.135 1627.21 Q136.218 1628.34 138.441 1628.9 Q140.663 1629.45 143.14 1629.45 Q147.144 1629.45 149.482 1627.35 Q151.82 1625.24 151.82 1621.63 Q151.82 1618.02 149.482 1615.91 Q147.144 1613.8 143.14 1613.8 Q141.265 1613.8 139.39 1614.22 Q137.538 1614.64 135.593 1615.52 L135.593 1598.16 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M49.5521 1369.11 L79.2279 1369.11 L79.2279 1373.04 L49.5521 1373.04 L49.5521 1369.11 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M89.3667 1351.38 L107.723 1351.38 L107.723 1355.31 L93.6491 1355.31 L93.6491 1363.78 Q94.6676 1363.44 95.6861 1363.28 Q96.7047 1363.09 97.7232 1363.09 Q103.51 1363.09 106.89 1366.26 Q110.269 1369.43 110.269 1374.85 Q110.269 1380.43 106.797 1383.53 Q103.325 1386.61 97.0056 1386.61 Q94.8297 1386.61 92.5612 1386.24 Q90.3158 1385.87 87.9084 1385.13 L87.9084 1380.43 Q89.9917 1381.56 92.2139 1382.12 Q94.4361 1382.67 96.913 1382.67 Q100.918 1382.67 103.256 1380.57 Q105.593 1378.46 105.593 1374.85 Q105.593 1371.24 103.256 1369.13 Q100.918 1367.03 96.913 1367.03 Q95.038 1367.03 93.163 1367.44 Q91.3112 1367.86 89.3667 1368.74 L89.3667 1351.38 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M119.482 1380.06 L124.367 1380.06 L124.367 1385.94 L119.482 1385.94 L119.482 1380.06 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M144.552 1354.46 Q140.941 1354.46 139.112 1358.02 Q137.306 1361.56 137.306 1368.69 Q137.306 1375.8 139.112 1379.36 Q140.941 1382.9 144.552 1382.9 Q148.186 1382.9 149.991 1379.36 Q151.82 1375.8 151.82 1368.69 Q151.82 1361.56 149.991 1358.02 Q148.186 1354.46 144.552 1354.46 M144.552 1350.75 Q150.362 1350.75 153.417 1355.36 Q156.496 1359.94 156.496 1368.69 Q156.496 1377.42 153.417 1382.03 Q150.362 1386.61 144.552 1386.61 Q138.741 1386.61 135.663 1382.03 Q132.607 1377.42 132.607 1368.69 Q132.607 1359.94 135.663 1355.36 Q138.741 1350.75 144.552 1350.75 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M50.5475 1122.33 L80.2233 1122.33 L80.2233 1126.27 L50.5475 1126.27 L50.5475 1122.33 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M94.3436 1135.22 L110.663 1135.22 L110.663 1139.16 L88.7186 1139.16 L88.7186 1135.22 Q91.3806 1132.47 95.9639 1127.84 Q100.57 1123.19 101.751 1121.84 Q103.996 1119.32 104.876 1117.58 Q105.779 1115.83 105.779 1114.14 Q105.779 1111.38 103.834 1109.64 Q101.913 1107.91 98.8111 1107.91 Q96.6121 1107.91 94.1584 1108.67 Q91.7278 1109.44 88.9501 1110.99 L88.9501 1106.27 Q91.7741 1105.13 94.2278 1104.55 Q96.6815 1103.97 98.7185 1103.97 Q104.089 1103.97 107.283 1106.66 Q110.478 1109.34 110.478 1113.83 Q110.478 1115.96 109.668 1117.89 Q108.881 1119.78 106.774 1122.38 Q106.195 1123.05 103.094 1126.27 Q99.9917 1129.46 94.3436 1135.22 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M120.478 1133.28 L125.362 1133.28 L125.362 1139.16 L120.478 1139.16 L120.478 1133.28 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M135.593 1104.6 L153.95 1104.6 L153.95 1108.53 L139.876 1108.53 L139.876 1117.01 Q140.894 1116.66 141.913 1116.5 Q142.931 1116.31 143.95 1116.31 Q149.737 1116.31 153.116 1119.48 Q156.496 1122.65 156.496 1128.07 Q156.496 1133.65 153.024 1136.75 Q149.552 1139.83 143.232 1139.83 Q141.056 1139.83 138.788 1139.46 Q136.542 1139.09 134.135 1138.35 L134.135 1133.65 Q136.218 1134.78 138.441 1135.34 Q140.663 1135.89 143.14 1135.89 Q147.144 1135.89 149.482 1133.79 Q151.82 1131.68 151.82 1128.07 Q151.82 1124.46 149.482 1122.35 Q147.144 1120.25 143.14 1120.25 Q141.265 1120.25 139.39 1120.66 Q137.538 1121.08 135.593 1121.96 L135.593 1104.6 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M99.3204 860.899 Q95.7093 860.899 93.8806 864.464 Q92.075 868.005 92.075 875.135 Q92.075 882.241 93.8806 885.806 Q95.7093 889.348 99.3204 889.348 Q102.955 889.348 104.76 885.806 Q106.589 882.241 106.589 875.135 Q106.589 868.005 104.76 864.464 Q102.955 860.899 99.3204 860.899 M99.3204 857.195 Q105.131 857.195 108.186 861.802 Q111.265 866.385 111.265 875.135 Q111.265 883.862 108.186 888.468 Q105.131 893.052 99.3204 893.052 Q93.5102 893.052 90.4315 888.468 Q87.376 883.862 87.376 875.135 Q87.376 866.385 90.4315 861.802 Q93.5102 857.195 99.3204 857.195 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M119.482 886.501 L124.367 886.501 L124.367 892.38 L119.482 892.38 L119.482 886.501 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M144.552 860.899 Q140.941 860.899 139.112 864.464 Q137.306 868.005 137.306 875.135 Q137.306 882.241 139.112 885.806 Q140.941 889.348 144.552 889.348 Q148.186 889.348 149.991 885.806 Q151.82 882.241 151.82 875.135 Q151.82 868.005 149.991 864.464 Q148.186 860.899 144.552 860.899 M144.552 857.195 Q150.362 857.195 153.417 861.802 Q156.496 866.385 156.496 875.135 Q156.496 883.862 153.417 888.468 Q150.362 893.052 144.552 893.052 Q138.741 893.052 135.663 888.468 Q132.607 883.862 132.607 875.135 Q132.607 866.385 135.663 861.802 Q138.741 857.195 144.552 857.195 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M94.3436 641.667 L110.663 641.667 L110.663 645.602 L88.7186 645.602 L88.7186 641.667 Q91.3806 638.912 95.9639 634.282 Q100.57 629.63 101.751 628.287 Q103.996 625.764 104.876 624.028 Q105.779 622.269 105.779 620.579 Q105.779 617.824 103.834 616.088 Q101.913 614.352 98.8111 614.352 Q96.6121 614.352 94.1584 615.116 Q91.7278 615.88 88.9501 617.431 L88.9501 612.708 Q91.7741 611.574 94.2278 610.996 Q96.6815 610.417 98.7185 610.417 Q104.089 610.417 107.283 613.102 Q110.478 615.787 110.478 620.278 Q110.478 622.407 109.668 624.329 Q108.881 626.227 106.774 628.819 Q106.195 629.491 103.094 632.708 Q99.9917 635.903 94.3436 641.667 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M120.478 639.722 L125.362 639.722 L125.362 645.602 L120.478 645.602 L120.478 639.722 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M135.593 611.042 L153.95 611.042 L153.95 614.977 L139.876 614.977 L139.876 623.449 Q140.894 623.102 141.913 622.94 Q142.931 622.755 143.95 622.755 Q149.737 622.755 153.116 625.926 Q156.496 629.097 156.496 634.514 Q156.496 640.093 153.024 643.194 Q149.552 646.273 143.232 646.273 Q141.056 646.273 138.788 645.903 Q136.542 645.532 134.135 644.792 L134.135 640.093 Q136.218 641.227 138.441 641.782 Q140.663 642.338 143.14 642.338 Q147.144 642.338 149.482 640.231 Q151.82 638.125 151.82 634.514 Q151.82 630.903 149.482 628.796 Q147.144 626.69 143.14 626.69 Q141.265 626.69 139.39 627.107 Q137.538 627.523 135.593 628.403 L135.593 611.042 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M89.3667 364.263 L107.723 364.263 L107.723 368.199 L93.6491 368.199 L93.6491 376.671 Q94.6676 376.323 95.6861 376.161 Q96.7047 375.976 97.7232 375.976 Q103.51 375.976 106.89 379.148 Q110.269 382.319 110.269 387.735 Q110.269 393.314 106.797 396.416 Q103.325 399.495 97.0056 399.495 Q94.8297 399.495 92.5612 399.124 Q90.3158 398.754 87.9084 398.013 L87.9084 393.314 Q89.9917 394.448 92.2139 395.004 Q94.4361 395.559 96.913 395.559 Q100.918 395.559 103.256 393.453 Q105.593 391.347 105.593 387.735 Q105.593 384.124 103.256 382.018 Q100.918 379.911 96.913 379.911 Q95.038 379.911 93.163 380.328 Q91.3112 380.745 89.3667 381.624 L89.3667 364.263 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M119.482 392.944 L124.367 392.944 L124.367 398.823 L119.482 398.823 L119.482 392.944 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M144.552 367.342 Q140.941 367.342 139.112 370.907 Q137.306 374.448 137.306 381.578 Q137.306 388.685 139.112 392.249 Q140.941 395.791 144.552 395.791 Q148.186 395.791 149.991 392.249 Q151.82 388.685 151.82 381.578 Q151.82 374.448 149.991 370.907 Q148.186 367.342 144.552 367.342 M144.552 363.638 Q150.362 363.638 153.417 368.245 Q156.496 372.828 156.496 381.578 Q156.496 390.305 153.417 394.911 Q150.362 399.495 144.552 399.495 Q138.741 399.495 135.663 394.911 Q132.607 390.305 132.607 381.578 Q132.607 372.828 135.663 368.245 Q138.741 363.638 144.552 363.638 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M89.1352 117.485 L111.357 117.485 L111.357 119.476 L98.8111 152.045 L93.9269 152.045 L105.732 121.42 L89.1352 121.42 L89.1352 117.485 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M120.478 146.165 L125.362 146.165 L125.362 152.045 L120.478 152.045 L120.478 146.165 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip140)" d="M135.593 117.485 L153.95 117.485 L153.95 121.42 L139.876 121.42 L139.876 129.892 Q140.894 129.545 141.913 129.383 Q142.931 129.198 143.95 129.198 Q149.737 129.198 153.116 132.369 Q156.496 135.54 156.496 140.957 Q156.496 146.536 153.024 149.638 Q149.552 152.716 143.232 152.716 Q141.056 152.716 138.788 152.346 Q136.542 151.975 134.135 151.235 L134.135 146.536 Q136.218 147.67 138.441 148.225 Q140.663 148.781 143.14 148.781 Q147.144 148.781 149.482 146.675 Q151.82 144.568 151.82 140.957 Q151.82 137.346 149.482 135.239 Q147.144 133.133 143.14 133.133 Q141.265 133.133 139.39 133.55 Q137.538 133.966 135.593 134.846 L135.593 117.485 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip142)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,1140.85 268.292,1302.61 270.6,1374.89 272.908,1357.49 275.216,1340.27 277.524,1195.56 279.832,1351.02 282.139,1235.57 284.447,1394.17 286.755,1300.22 289.063,1286.08 291.371,1238.72 293.679,1426.68 295.987,1414 298.295,1434.29 300.603,1247.89 302.911,1566.12 305.219,1454.43 307.527,1416.62 309.834,1292.67 312.142,1448.49 314.45,1597.11 316.758,1154.54 319.066,1296.78 321.374,1260.95 323.682,1443.63 325.99,1266.03 328.298,1387.53 330.606,1292.72 332.914,1310.67 335.221,1195.8 337.529,1401.79 339.837,1364.82 342.145,1307.33 344.453,1382.7 346.761,1329.85 349.069,1255.33 351.377,1374.45 353.685,1310.5 355.993,1373.48 358.301,1287.08 360.608,1259.61 362.916,1409.51 365.224,1413.09 367.532,1471.74 369.84,1390.26 372.148,1490.8 374.456,1279.71 376.764,1402.93 379.072,1387.26 381.38,1344.16 383.688,1501.85 385.996,1456.8 388.303,1378.39 390.611,1397.27 392.919,1426.89 395.227,1345.93 397.535,1250.88 399.843,1407.46 402.151,1190.7 404.459,1190 406.767,1221.24 409.075,1367.91 411.383,1257.02 413.69,1112.1 415.998,1508 418.306,1375.25 420.614,1408.52 422.922,1296.04 425.23,1284.27 427.538,1443.1 429.846,1481.76 432.154,1444.84 434.462,1363.18 436.77,1471.52 439.077,1328.88 441.385,1527.4 443.693,1379.58 446.001,1336.83 448.309,1316.06 450.617,1386.09 452.925,1462.52 455.233,1490.98 457.541,1547.55 459.849,1248.73 462.157,1328.19 464.465,1231.08 466.772,1541.07 469.08,1360.53 471.388,1396.23 473.696,1362.99 476.004,1288.52 478.312,1443.54 480.62,1360.96 482.928,1271.88 485.236,1365.86 487.544,1346.21 489.852,1537.24 492.159,1295.16 494.467,1273.42 496.775,1422.24 499.083,1172.74 501.391,1362.42 503.699,1311.36 506.007,1465.26 508.315,1315.33 510.623,1453.3 512.931,1152.41 515.239,1257.99 517.546,1384.05 519.854,1402.77 522.162,1234.63 524.47,1530.78 526.778,1254.18 529.086,1353.95 531.394,1543.88 533.702,1406.85 536.01,1272.8 538.318,1295.44 540.626,1548.97 542.933,1442.32 545.241,1160.84 547.549,1325.62 549.857,1379.32 552.165,1334.02 554.473,1454.86 556.781,1329.99 559.089,1309.23 561.397,1364.11 563.705,1658.67 566.013,1350.73 568.321,1328.25 570.628,1418.46 572.936,1524.63 575.244,1324.12 577.552,1562.98 579.86,1266.81 582.168,1253.53 584.476,1300.34 586.784,1359 589.092,1371.86 591.4,1269.79 593.708,1223.35 596.015,1217.02 598.323,1442.1 600.631,1367.5 602.939,1164.04 605.247,1236.36 607.555,1424.86 609.863,1235.35 612.171,1386.53 614.479,1277.11 616.787,1400.46 619.095,1389.98 621.402,1244.46 623.71,1313.8 626.018,1588.78 628.326,1285.21 630.634,1354.35 632.942,1330.77 635.25,1152.35 637.558,1279.72 639.866,1215.06 642.174,1493.84 644.482,1360.45 646.79,1274.13 649.097,1582.37 651.405,1469.96 653.713,1489.18 656.021,1330.12 658.329,1349.87 660.637,1350.72 662.945,1242.18 665.253,1389.61 667.561,1459.91 669.869,1441.05 672.177,1419.97 674.484,1281.35 676.792,1332.8 679.1,1448.32 681.408,1393.96 683.716,1469.8 686.024,1379.73 688.332,1281.47 690.64,1390.17 692.948,1239.75 695.256,1428.39 697.564,1359.99 699.871,1373 702.179,1507.77 704.487,1370.04 706.795,1403.81 709.103,1266.79 711.411,1296.97 713.719,1366.01 716.027,1543.56 718.335,1271.27 720.643,1596.09 722.951,1341.55 725.259,1297.87 727.566,1510.64 729.874,1414.71 732.182,1459.68 734.49,1429.53 736.798,1485.25 739.106,1348.69 741.414,1488.79 743.722,1488.44 746.03,1356.1 748.338,1305.95 750.646,1346.05 752.953,1338.59 755.261,1342.07 757.569,1333.49 759.877,1552.06 762.185,1294.17 764.493,1406.77 766.801,1276.28 769.109,1338.23 771.417,1478.51 773.725,1390.81 776.033,1443.08 778.34,1297.98 780.648,1306.23 782.956,1326.61 785.264,1375.19 787.572,1352.79 789.88,1303.82 792.188,1335.79 794.496,1516.13 796.804,1362.56 799.112,1485.25 801.42,1347.5 803.728,1494.8 806.035,1177.71 808.343,1370.64 810.651,1132.46 812.959,1453.2 815.267,1429 817.575,1455.49 819.883,1287.26 822.191,1363.88 824.499,1226.31 826.807,1209.99 829.115,1275.45 831.422,1288.16 833.73,1382.13 836.038,1370.35 838.346,1372.8 840.654,1420.14 842.962,1302.48 845.27,1271.79 847.578,1354.67 849.886,1509.48 852.194,1391.85 854.502,1325.55 856.809,1239.3 859.117,1321 861.425,1553.66 863.733,1348.91 866.041,1478.22 868.349,1281.03 870.657,1491.27 872.965,1402.51 875.273,1326.43 877.581,1369.66 879.889,1386.44 882.197,1181.91 884.504,1434.18 886.812,1186.97 889.12,1379.67 891.428,1412.95 893.736,1581.31 896.044,1298.72 898.352,1454.41 900.66,1442.65 902.968,1401.74 905.276,1293.6 907.584,1327.68 909.891,1487.66 912.199,1311.15 914.507,1435.89 916.815,1491.37 919.123,1570.38 921.431,1251.84 923.739,1445.52 926.047,1383.04 928.355,1343.94 930.663,1406.83 932.971,1440.5 935.278,1253.64 937.586,1309.41 939.894,1452.08 942.202,1469.86 944.51,1440.39 946.818,1403.57 949.126,1447.88 951.434,1399.76 953.742,1414.38 956.05,1276.94 958.358,1240.19 960.665,1294.94 962.973,1448.67 965.281,1256.75 967.589,1266.68 969.897,1204.31 972.205,1337.98 974.513,1449.14 976.821,1443.51 979.129,1356.53 981.437,1336.42 983.745,1454.4 986.053,1304.88 988.36,1369.98 990.668,1399.19 992.976,1330.32 995.284,1231.95 997.592,1453.97 999.9,1322.15 1002.21,1504.09 1004.52,1157.54 1006.82,1285.54 1009.13,1473.07 1011.44,1360.81 1013.75,1405.43 1016.06,1444.14 1018.36,1501.93 1020.67,1503.21 1022.98,1204.88 1025.29,1350.34 1027.59,1352.17 1029.9,1545.17 1032.21,1260.89 1034.52,1315.57 1036.83,1449.41 1039.13,1380.45 1041.44,1342.95 1043.75,1355.61 1046.06,1497.59 1048.37,1330.85 1050.67,1146.16 1052.98,1434.33 1055.29,1472.5 1057.6,1340.04 1059.91,1319.35 1062.21,1426.18 1064.52,1345.75 1066.83,1138.47 1069.14,1217.2 1071.45,1391.23 1073.75,1408.36 1076.06,1293.64 1078.37,1463 1080.68,1328.38 1082.98,1452.48 1085.29,1376.87 1087.6,1475.59 1089.91,1227.23 1092.22,1306.67 1094.52,1514.35 1096.83,1313.44 1099.14,1261.16 1101.45,1323.67 1103.76,1508.64 1106.06,1180.46 1108.37,1189.7 1110.68,1283.93 1112.99,1428.75 1115.3,1484.16 1117.6,1208.5 1119.91,1392.45 1122.22,1402.11 1124.53,1445.38 1126.84,1420.49 1129.14,1472.86 1131.45,1344.18 1133.76,1500.27 1136.07,1211.3 1138.37,1534.55 1140.68,1396.91 1142.99,1219.49 1145.3,1303.16 1147.61,1297.1 1149.91,1523.42 1152.22,1078.84 1154.53,1347.96 1156.84,1189.02 1159.15,1426.22 1161.45,1199.23 1163.76,1465.31 1166.07,1254.24 1168.38,1419.54 1170.69,1372.32 1172.99,1284.65 1175.3,1301.58 1177.61,1492.09 1179.92,1447.81 1182.23,1418.68 1184.53,1324.92 1186.84,1335.6 1189.15,1436.51 1191.46,1327.1 1193.76,1325.56 1196.07,1306.76 1198.38,1250.98 1200.69,1417.67 1203,1382.74 1205.3,1341.28 1207.61,1309.24 1209.92,1287.37 1212.23,1200.66 1214.54,1468.96 1216.84,1405.17 1219.15,1256.5 1221.46,1279.04 1223.77,1333.26 1226.08,1559.94 1228.38,1463.21 1230.69,1549.11 1233,1343.92 1235.31,1334.04 1237.61,1328.19 1239.92,1345.93 1242.23,1224.97 1244.54,1346.2 1246.85,1391.76 1249.15,1359.94 1251.46,1504.97 1253.77,1262.68 1256.08,1226.65 1258.39,1298.07 1260.69,1578.29 1263,1446.44 1265.31,1481.42 1267.62,1386.49 1269.93,1350.4 1272.23,1483 1274.54,1402.45 1276.85,1358.62 1279.16,1319.23 1281.47,1393.54 1283.77,1398.88 1286.08,1403.67 1288.39,1349.42 1290.7,1451.41 1293,1352.11 1295.31,1157.22 1297.62,1355.54 1299.93,1382.13 1302.24,1510.3 1304.54,1424.59 1306.85,1385.66 1309.16,1577.81 1311.47,1366.82 1313.78,1416.85 1316.08,1378.2 1318.39,1467.81 1320.7,1500.08 1323.01,1258.6 1325.32,1378.17 1327.62,1279.89 1329.93,1413.7 1332.24,1283 1334.55,1395.95 1336.86,1228.11 1339.16,1284.77 1341.47,1462.38 1343.78,1308.63 1346.09,1361.82 1348.39,1412.57 1350.7,1437.26 1353.01,1393.67 1355.32,1369.94 1357.63,1415.75 1359.93,1229.58 1362.24,1318.07 1364.55,1459.22 1366.86,1465.52 1369.17,1193.56 1371.47,1375.86 1373.78,1484.43 1376.09,1289.27 1378.4,1371.46 1380.71,1403.58 1383.01,1332.96 1385.32,1246.98 1387.63,1281.87 1389.94,1331.63 1392.24,1352.03 1394.55,1366.14 1396.86,1471.3 1399.17,1175.19 1401.48,1277.54 1403.78,1236.13 1406.09,1355.37 1408.4,1346.26 1410.71,1451.1 1413.02,1448.7 1415.32,1277.5 1417.63,1288.44 1419.94,1497.76 1422.25,1418.51 1424.56,1427.03 1426.86,1421.46 1429.17,1309.9 1431.48,1361.15 1433.79,1401.03 1436.1,1363.66 1438.4,1355.68 1440.71,1408.33 1443.02,1207.66 1445.33,1349.92 1447.63,1315.05 1449.94,1290.84 1452.25,1314.11 1454.56,1276.8 1456.87,1452.33 1459.17,1324.04 1461.48,1487.9 1463.79,1249.66 1466.1,1426.97 1468.41,1232.41 1470.71,1277.67 1473.02,1308.47 1475.33,1491.21 1477.64,1387.2 1479.95,1256.66 1482.25,1392.11 1484.56,1383.05 1486.87,1486.04 1489.18,1157.84 1491.49,1334.09 1493.79,1189.5 1496.1,1233.75 1498.41,1502.88 1500.72,1443.76 1503.02,1314.71 1505.33,1313.96 1507.64,1613.53 1509.95,1421.52 1512.26,1341.76 1514.56,1372.58 1516.87,1243.19 1519.18,1246.21 1521.49,1442.64 1523.8,1424.78 1526.1,1204.33 1528.41,1379.28 1530.72,1313.35 1533.03,1318.69 1535.34,1335.1 1537.64,1468.48 1539.95,1410.46 1542.26,1304.58 1544.57,1504.21 1546.88,1376.1 1549.18,1240.3 1551.49,1149.99 1553.8,1388.64 1556.11,1372.58 1558.41,1569.91 1560.72,1471.47 1563.03,1336.24 1565.34,1258.35 1567.65,1582.26 1569.95,1533.21 1572.26,1256.25 1574.57,1218 1576.88,1383.62 1579.19,1485.44 1581.49,1450.04 1583.8,1281.19 1586.11,1234.97 1588.42,1402.92 1590.73,1423.08 1593.03,1491.2 1595.34,1366.78 1597.65,1474.59 1599.96,1507.58 1602.26,1349.02 1604.57,1312.71 1606.88,1520.56 1609.19,1520.92 1611.5,1262.77 1613.8,1453.45 1616.11,1286.83 1618.42,1341.43 1620.73,1338.09 1623.04,1491.11 1625.34,1148.22 1627.65,1406.58 1629.96,1374.45 1632.27,1422.36 1634.58,1475.61 1636.88,1188.62 1639.19,1221.31 1641.5,1545.07 1643.81,1243.45 1646.12,1423.98 1648.42,1495.29 1650.73,1243.53 1653.04,1353.56 1655.35,1463.21 1657.65,1505.11 1659.96,1276.22 1662.27,1379.14 1664.58,1484.85 1666.89,1268.97 1669.19,1239.75 1671.5,1553.14 1673.81,1426.98 1676.12,1315.71 1678.43,1403.08 1680.73,1296.86 1683.04,1350.94 1685.35,1290.17 1687.66,1361.63 1689.97,1244.19 1692.27,1360.19 1694.58,1338.52 1696.89,1543.34 1699.2,1354.99 1701.51,1383.49 1703.81,1463.64 1706.12,1317.67 1708.43,1306.59 1710.74,1337.46 1713.04,1397.34 1715.35,1334.4 1717.66,1280.19 1719.97,1400.63 1722.28,1440.12 1724.58,1366.78 1726.89,1304.79 1729.2,1328.37 1731.51,1298.89 1733.82,1431.2 1736.12,1323.82 1738.43,1310.25 1740.74,1389.62 1743.05,1426.09 1745.36,1432.54 1747.66,1415.43 1749.97,1275.56 1752.28,1350.5 1754.59,1430.96 1756.9,1470.39 1759.2,1416.46 1761.51,1402.03 1763.82,1405.19 1766.13,1396.56 1768.43,1218.52 1770.74,1243.73 1773.05,1365.74 1775.36,1566 1777.67,1309.82 1779.97,1253.64 1782.28,1436.33 1784.59,1272.41 1786.9,1509.9 1789.21,1237.31 1791.51,1312.17 1793.82,1342.25 1796.13,1195.26 1798.44,1316.71 1800.75,1360.55 1803.05,1193.81 1805.36,1202.36 1807.67,1564.04 1809.98,1399.19 1812.28,1352.31 1814.59,1335.82 1816.9,1263.85 1819.21,1382.72 1821.52,1309.1 1823.82,1394.68 1826.13,1295.94 1828.44,1353.68 1830.75,1214.55 1833.06,1258.38 1835.36,1491.99 1837.67,1454.69 1839.98,1323.96 1842.29,1540.1 1844.6,1405.65 1846.9,1259.06 1849.21,1227.63 1851.52,1352.79 1853.83,1367.53 1856.14,1424.62 1858.44,1364.12 1860.75,1338.33 1863.06,1112.45 1865.37,1269.78 1867.67,1324.85 1869.98,1262.64 1872.29,1281.88 1874.6,1370.15 1876.91,1252.46 1879.21,1432.88 1881.52,1324.1 1883.83,1402.14 1886.14,1320.53 1888.45,1279.91 1890.75,1334.53 1893.06,1325.97 1895.37,1118.83 1897.68,1511.01 1899.99,1423.18 1902.29,1345.59 1904.6,1517.97 1906.91,1330.36 1909.22,1221.87 1911.53,1386.86 1913.83,1508.97 1916.14,1368.56 1918.45,1427.18 1920.76,1440.25 1923.06,1301.22 1925.37,1386.63 1927.68,1426.54 1929.99,1487.34 1932.3,1358 1934.6,1274.34 1936.91,1527.57 1939.22,1287.75 1941.53,1364.32 1943.84,1244.72 1946.14,1137.31 1948.45,1487.31 1950.76,1593.3 1953.07,1374.01 1955.38,1265.43 1957.68,1361.29 1959.99,1628.44 1962.3,1361.66 1964.61,1188.93 1966.91,1299.54 1969.22,1375.98 1971.53,1342.14 1973.84,1388.69 1976.15,1604.6 1978.45,1309.79 1980.76,1365.5 1983.07,1467.1 1985.38,1319.57 1987.69,1378.22 1989.99,1443.14 1992.3,1375.44 1994.61,1286.81 1996.92,1400.87 1999.23,1400.08 2001.53,1211.07 2003.84,1475.87 2006.15,1382.26 2008.46,1406.72 2010.77,1264.55 2013.07,1563.32 2015.38,1414.01 2017.69,1340.73 2020,1338.87 2022.3,1591.25 2024.61,1528.67 2026.92,1410.69 2029.23,1303.08 2031.54,1380.28 2033.84,1366.91 2036.15,1248.72 2038.46,1371.25 2040.77,1297.39 2043.08,1350.17 2045.38,1236.16 2047.69,1384.55 2050,1350.76 2052.31,1304.73 2054.62,1360.36 2056.92,1545.23 2059.23,1349.59 2061.54,1263.97 2063.85,1206.2 2066.16,1368.28 2068.46,1295.22 2070.77,1323.51 2073.08,1344.55 2075.39,1304.63 2077.69,1412.19 2080,1310.49 2082.31,1378.34 2084.62,1266.76 2086.93,1344.65 2089.23,1454.24 2091.54,1560.08 2093.85,1464.98 2096.16,1499.68 2098.47,1491.85 2100.77,1399.72 2103.08,1390.26 2105.39,1410.98 2107.7,1646.56 2110.01,1442.29 2112.31,1269.63 2114.62,1338.28 2116.93,1338.57 2119.24,1433.25 2121.55,1300.53 2123.85,1133.18 2126.16,1353.42 2128.47,1583.9 2130.78,1367.02 2133.08,1337.1 2135.39,1308.51 2137.7,1366.73 2140.01,1272.6 2142.32,1421.73 2144.62,1403.27 2146.93,1469.61 2149.24,1478.81 2151.55,1230.78 2153.86,1254.78 2156.16,1254.74 2158.47,1440.82 2160.78,1272.18 2163.09,1432.27 2165.4,1252.34 2167.7,1501.74 2170.01,1205.68 2172.32,1326.22 2174.63,1508.29 2176.93,1470.35 2179.24,1224.16 2181.55,1381.28 2183.86,1310.9 2186.17,1243.33 2188.47,1406.05 2190.78,1371.97 2193.09,1168.07 2195.4,1353.48 2197.71,1303.34 2200.01,1407.78 2202.32,1425.66 2204.63,1443.08 2206.94,1273.82 2209.25,1387.46 2211.55,1439.05 2213.86,1552.56 2216.17,1314.14 2218.48,1440.51 2220.79,1603.83 2223.09,1385.85 2225.4,1359.42 2227.71,1430.31 2230.02,1479.45 2232.32,1420.42 2234.63,1216.62 2236.94,1422.52 2239.25,1218.65 2241.56,1378 2243.86,1285.05 2246.17,1406.77 2248.48,1322.63 2250.79,1336.93 2253.1,1438.42 2255.4,1586.55 2257.71,1453.44 2260.02,1253.71 2262.33,1146.57 2264.64,1450.95 2266.94,1469.6 2269.25,1332.31 2271.56,1449.52 2273.87,1358.23 2276.18,1301.92 2278.48,1535.95 2280.79,1477.1 2283.1,1433.32 2285.41,1350.31 2287.71,1404.05 2290.02,1528.17 2292.33,1289.74 2294.64,1437.36 2296.95,1313.74 2299.25,1354.43 2301.56,1313.85 2303.87,1349.31 2306.18,1263.44 2308.49,1565.16 2310.79,1199.74 2313.1,1271.18 2315.41,1364.01 2317.72,1333.34 2320.03,1489.06 2322.33,1356.13 2324.64,1124.91 2326.95,1346.61 2329.26,1369.89 2331.56,1198.27 2333.87,1376.62 2336.18,1512.53 2338.49,1367.9 2340.8,1338.48 2343.1,1397.1 2345.41,1343.85 2347.72,1387.68 2350.03,1556.81 2352.34,1204.39 2354.64,1228.26 2356.95,1321.59 2359.26,1363.25 2361.57,1384.77 2363.88,1262.72 2366.18,1255.84 2368.49,1401.33 2370.8,1335.22 2373.11,1325.74 2375.42,1480.74 2377.72,1362.43 2380.03,1531.54 2382.34,1295.15 2384.65,1369.46 2386.95,1322.09 2389.26,1486.66 2391.57,1420.78 2393.88,1486.36 2396.19,1269.96 2398.49,1505.16 2400.8,1382.89 2403.11,1286.29 2405.42,1343.87 2407.73,1422.6 2410.03,1482.33 2412.34,1266.08 2414.65,1366.45 2416.96,1457.91 2419.27,1385.7 2421.57,1403.38 2423.88,1277.34 2426.19,1352.38 2428.5,1282.58 2430.81,1353.77 2433.11,1271.85 2435.42,1219.96 2437.73,1262.39 2440.04,1350.68 2442.34,1355.15 2444.65,1267.08 2446.96,1335.57 2449.27,1321.46 2451.58,1403.13 2453.88,1293.45 2456.19,1491.66 2458.5,1319.48 2460.81,1361.55 2463.12,1357.51 2465.42,1307.93 2467.73,1471.2 2470.04,1302.11 2472.35,1491.7 2474.66,1194.56 2476.96,1311.57 2479.27,1603.24 2481.58,1489.57 2483.89,1261.22 2486.2,1364.07 2488.5,1512.22 2490.81,1379.84 2493.12,1545.43 2495.43,1445.1 2497.73,1499.13 2500.04,1330.98 2502.35,1358.53 2504.66,1249.55 2506.97,1353.22 2509.27,1236.89 2511.58,1424.07 2513.89,1359.33 2516.2,1429.79 2518.51,1258.02 2520.81,1409.28 2523.12,1467.04 2525.43,1383.33 2527.74,1486.04 2530.05,1429.93 2532.35,1460.12 2534.66,1471.25 2536.97,1311.15 2539.28,1298.17 2541.58,1751.15 2543.89,1359.15 2546.2,1464.98 2548.51,1352.47 2550.82,1327.46 2553.12,1195.01 2555.43,1219.06 2557.74,1496.73 2560.05,1417.29 2562.36,1434.45 2564.66,1204.82 2566.97,1496.86 2569.28,1384.35 2571.59,1277.03 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,824.265 268.292,996.328 270.6,919.008 272.908,817.08 275.216,835.283 277.524,634.834 279.832,953.927 282.139,836.32 284.447,912.565 286.755,888.511 289.063,1047.49 291.371,874.367 293.679,854.057 295.987,812.614 298.295,933.294 300.603,714.976 302.911,768.516 305.219,983.932 307.527,954.929 309.834,847.35 312.142,718.877 314.45,890.377 316.758,656.57 319.066,748.157 321.374,909.348 323.682,647.267 325.99,974.358 328.298,712.185 330.606,785.656 332.914,604.269 335.221,1124.58 337.529,923.703 339.837,758.347 342.145,978.85 344.453,816.927 346.761,980.481 349.069,914.094 351.377,856.349 353.685,974.876 355.993,734.578 358.301,805.377 360.608,882.56 362.916,805.968 365.224,742.778 367.532,809.473 369.84,872.436 372.148,790.222 374.456,796.367 376.764,867.443 379.072,870.043 381.38,947.23 383.688,977.719 385.996,852.395 388.303,845.922 390.611,917.169 392.919,851.736 395.227,986.957 397.535,969.953 399.843,852.01 402.151,914.349 404.459,703.579 406.767,773.894 409.075,937.667 411.383,852.133 413.69,868.875 415.998,929.592 418.306,1055.81 420.614,942.732 422.922,925.35 425.23,706.346 427.538,1020.34 429.846,885.257 432.154,910.589 434.462,794.829 436.77,887.905 439.077,984.867 441.385,613.701 443.693,922.549 446.001,933.21 448.309,832.165 450.617,722.981 452.925,740.264 455.233,764.602 457.541,907.892 459.849,900.979 462.157,873.95 464.465,862.045 466.772,963.399 469.08,956.656 471.388,904.668 473.696,863.734 476.004,841.268 478.312,782.815 480.62,980.449 482.928,895.549 485.236,1039.59 487.544,858.04 489.852,962.299 492.159,754.03 494.467,836.069 496.775,866.519 499.083,841.868 501.391,858.381 503.699,754.9 506.007,850.562 508.315,763.824 510.623,829.708 512.931,848.719 515.239,857.522 517.546,832.282 519.854,855.215 522.162,1029.32 524.47,824.071 526.778,839.081 529.086,844.182 531.394,751.44 533.702,835.674 536.01,755.027 538.318,1002.32 540.626,887.887 542.933,927.823 545.241,842.117 547.549,751.34 549.857,847.776 552.165,862.171 554.473,817.416 556.781,924.371 559.089,986.066 561.397,859.995 563.705,869.961 566.013,667.688 568.321,866.671 570.628,1016.6 572.936,737.233 575.244,773.78 577.552,727.448 579.86,867.066 582.168,705.73 584.476,1065.29 586.784,836.455 589.092,860.268 591.4,1018.43 593.708,986.052 596.015,767.888 598.323,917.389 600.631,922.234 602.939,965.402 605.247,841.308 607.555,757.07 609.863,993.003 612.171,975.167 614.479,808.673 616.787,820.463 619.095,1009.59 621.402,718.921 623.71,987.178 626.018,1040.3 628.326,825.652 630.634,806.694 632.942,1043.79 635.25,805.492 637.558,733.811 639.866,736.884 642.174,713.497 644.482,843.283 646.79,910.191 649.097,805.866 651.405,845.313 653.713,929.618 656.021,879.014 658.329,801.027 660.637,864.006 662.945,956.281 665.253,889.624 667.561,965.873 669.869,847.053 672.177,996.679 674.484,849.082 676.792,866.616 679.1,703.554 681.408,974.783 683.716,929.481 686.024,821.604 688.332,955.941 690.64,925.062 692.948,828.556 695.256,877.447 697.564,889.314 699.871,811.902 702.179,720.32 704.487,629.244 706.795,961.073 709.103,728.936 711.411,918.914 713.719,944.974 716.027,955.857 718.335,729.215 720.643,798.089 722.951,730.183 725.259,728.055 727.566,891.099 729.874,788.863 732.182,858.462 734.49,739.173 736.798,1071.08 739.106,836.075 741.414,963.139 743.722,900.417 746.03,707.339 748.338,743.019 750.646,850.882 752.953,798.001 755.261,816.926 757.569,962.598 759.877,717.653 762.185,868.446 764.493,894.837 766.801,882.527 769.109,861.47 771.417,906.013 773.725,952.574 776.033,784.84 778.34,810.383 780.648,839.064 782.956,915.474 785.264,978.733 787.572,944.389 789.88,902.544 792.188,831.574 794.496,767.339 796.804,964.084 799.112,1010.18 801.42,837.673 803.728,1145.95 806.035,932.024 808.343,938.71 810.651,928.557 812.959,950.749 815.267,737.215 817.575,904.042 819.883,752.938 822.191,912.32 824.499,939.047 826.807,867.783 829.115,623.744 831.422,774.28 833.73,779.775 836.038,971.006 838.346,1050.36 840.654,792.739 842.962,828.095 845.27,870.666 847.578,906.095 849.886,1017.92 852.194,981.956 854.502,806.812 856.809,879.74 859.117,874.831 861.425,832.019 863.733,729.922 866.041,942.802 868.349,801.419 870.657,815.957 872.965,870.734 875.273,834.781 877.581,930.084 879.889,868.161 882.197,990.677 884.504,904.551 886.812,867.385 889.12,663.516 891.428,974.255 893.736,952.143 896.044,994.612 898.352,877.982 900.66,695.519 902.968,889.809 905.276,1116.42 907.584,812.556 909.891,782.373 912.199,852.737 914.507,763.105 916.815,673.768 919.123,966.785 921.431,883.951 923.739,781.412 926.047,968.593 928.355,1000 930.663,918.394 932.971,800.042 935.278,837.114 937.586,863.075 939.894,854.72 942.202,848.391 944.51,1016.11 946.818,771.095 949.126,865.827 951.434,981.001 953.742,977.677 956.05,779.334 958.358,891.985 960.665,906.575 962.973,914.946 965.281,1076.56 967.589,717.847 969.897,954.798 972.205,1036.9 974.513,830.573 976.821,953.678 979.129,826.246 981.437,776.648 983.745,735.959 986.053,850.911 988.36,953.948 990.668,798.103 992.976,951.5 995.284,866.82 997.592,877.836 999.9,780.321 1002.21,748.649 1004.52,931.715 1006.82,894.902 1009.13,942.828 1011.44,812.678 1013.75,844.019 1016.06,890.402 1018.36,915.534 1020.67,850.099 1022.98,1018.02 1025.29,777.488 1027.59,833.69 1029.9,719.161 1032.21,778.897 1034.52,886.19 1036.83,847.727 1039.13,907.022 1041.44,905.145 1043.75,1043.41 1046.06,755.774 1048.37,884.99 1050.67,821.613 1052.98,788.174 1055.29,1005.35 1057.6,764.581 1059.91,782.258 1062.21,810.571 1064.52,1023.9 1066.83,862.763 1069.14,811.797 1071.45,789.182 1073.75,793.696 1076.06,958.206 1078.37,1023.88 1080.68,1037.04 1082.98,916.851 1085.29,939.091 1087.6,832.008 1089.91,966.604 1092.22,865.245 1094.52,792 1096.83,918.063 1099.14,738.6 1101.45,697.247 1103.76,942.935 1106.06,896.297 1108.37,921.442 1110.68,776.433 1112.99,953.958 1115.3,779.545 1117.6,802.837 1119.91,779.148 1122.22,870.311 1124.53,824.765 1126.84,829.825 1129.14,1028.04 1131.45,928.991 1133.76,881.874 1136.07,903.151 1138.37,1033.06 1140.68,854.884 1142.99,847.862 1145.3,916.394 1147.61,900.482 1149.91,882.077 1152.22,949.803 1154.53,792.002 1156.84,894.07 1159.15,740.944 1161.45,746.506 1163.76,948.219 1166.07,840.665 1168.38,875.567 1170.69,915.737 1172.99,943.624 1175.3,860.09 1177.61,892.541 1179.92,1020.01 1182.23,938.523 1184.53,895.469 1186.84,681.645 1189.15,942.221 1191.46,1016.69 1193.76,866.417 1196.07,909.891 1198.38,907.64 1200.69,1021.02 1203,767.625 1205.3,1005.02 1207.61,948.184 1209.92,726.21 1212.23,960.187 1214.54,839.691 1216.84,789.337 1219.15,766.305 1221.46,787.969 1223.77,777.665 1226.08,899.909 1228.38,751.607 1230.69,882.479 1233,846.914 1235.31,916.153 1237.61,845.648 1239.92,808.201 1242.23,959.07 1244.54,838.866 1246.85,600.366 1249.15,846.131 1251.46,923.167 1253.77,820.122 1256.08,773.555 1258.39,945.453 1260.69,886.42 1263,737.776 1265.31,572.494 1267.62,1206.44 1269.93,702.864 1272.23,755.688 1274.54,869.993 1276.85,1055.72 1279.16,765.524 1281.47,736.816 1283.77,878.2 1286.08,748.576 1288.39,1029.91 1290.7,772.118 1293,881.712 1295.31,948.537 1297.62,876.771 1299.93,938.09 1302.24,916.275 1304.54,887.932 1306.85,763.49 1309.16,986.985 1311.47,976.35 1313.78,870.873 1316.08,846.609 1318.39,927.764 1320.7,848.674 1323.01,937.729 1325.32,828.601 1327.62,731.478 1329.93,914.138 1332.24,787.786 1334.55,995.608 1336.86,927.3 1339.16,819.491 1341.47,911.339 1343.78,759.622 1346.09,936.78 1348.39,783.758 1350.7,1074.07 1353.01,797.534 1355.32,991.576 1357.63,965.645 1359.93,670.865 1362.24,736.495 1364.55,1120.97 1366.86,984.398 1369.17,856.754 1371.47,815.967 1373.78,863.758 1376.09,1018.67 1378.4,914.42 1380.71,934.683 1383.01,978.448 1385.32,990.728 1387.63,723.619 1389.94,1043.2 1392.24,872.536 1394.55,706.888 1396.86,728.903 1399.17,879.565 1401.48,935.915 1403.78,827.556 1406.09,898.103 1408.4,932.317 1410.71,841.944 1413.02,1055.96 1415.32,846.027 1417.63,881.197 1419.94,831.562 1422.25,828.92 1424.56,858.556 1426.86,1022.3 1429.17,893.92 1431.48,792.016 1433.79,808.279 1436.1,911.816 1438.4,867.022 1440.71,993.641 1443.02,922.865 1445.33,760.604 1447.63,791.176 1449.94,706.272 1452.25,760.603 1454.56,875.698 1456.87,1046.98 1459.17,754.059 1461.48,897.618 1463.79,804.332 1466.1,883.193 1468.41,1092.1 1470.71,1075.99 1473.02,847.176 1475.33,872.387 1477.64,791.742 1479.95,830.349 1482.25,823.837 1484.56,965.009 1486.87,824.516 1489.18,728.336 1491.49,787.697 1493.79,957.204 1496.1,765.448 1498.41,937.45 1500.72,910.99 1503.02,826.654 1505.33,878.689 1507.64,953.636 1509.95,809.123 1512.26,1081.24 1514.56,743.263 1516.87,838.543 1519.18,840.875 1521.49,968.239 1523.8,793.455 1526.1,821.519 1528.41,836.142 1530.72,904.369 1533.03,685.701 1535.34,885.149 1537.64,842.679 1539.95,923.511 1542.26,1107.46 1544.57,825.453 1546.88,771.888 1549.18,768.682 1551.49,846.114 1553.8,745.136 1556.11,907.989 1558.41,885.541 1560.72,961.865 1563.03,893.887 1565.34,914.847 1567.65,1060.58 1569.95,1079.69 1572.26,898.662 1574.57,948.135 1576.88,845.88 1579.19,939.922 1581.49,738.965 1583.8,888.691 1586.11,912.943 1588.42,1013.09 1590.73,879.54 1593.03,857.381 1595.34,983.922 1597.65,824.115 1599.96,763.232 1602.26,772.168 1604.57,982.892 1606.88,935.037 1609.19,873.359 1611.5,723.717 1613.8,864.355 1616.11,629.839 1618.42,826.419 1620.73,843.893 1623.04,925.014 1625.34,727.157 1627.65,849.201 1629.96,816.002 1632.27,957.715 1634.58,692.701 1636.88,1003.03 1639.19,790.902 1641.5,828.975 1643.81,832.158 1646.12,838.581 1648.42,917.336 1650.73,816.05 1653.04,774.585 1655.35,963.939 1657.65,876.312 1659.96,919.822 1662.27,885.698 1664.58,753.008 1666.89,1053.86 1669.19,820.986 1671.5,776.849 1673.81,1006.26 1676.12,785.635 1678.43,958.137 1680.73,828.902 1683.04,1012.32 1685.35,827.757 1687.66,943.369 1689.97,836.271 1692.27,1094.52 1694.58,760.117 1696.89,951.513 1699.2,908.69 1701.51,800.38 1703.81,952.399 1706.12,829.472 1708.43,933.377 1710.74,1020.6 1713.04,766.523 1715.35,884.378 1717.66,927.101 1719.97,804.262 1722.28,919.153 1724.58,964.381 1726.89,899.18 1729.2,981.17 1731.51,826.364 1733.82,948.761 1736.12,919.114 1738.43,828.743 1740.74,1082.78 1743.05,878.256 1745.36,964.127 1747.66,1073.83 1749.97,831.809 1752.28,833.247 1754.59,740.544 1756.9,972.941 1759.2,821.514 1761.51,936.896 1763.82,856.344 1766.13,663.917 1768.43,745.337 1770.74,857.642 1773.05,773.067 1775.36,945.746 1777.67,891.242 1779.97,755.66 1782.28,951.193 1784.59,847.633 1786.9,793.139 1789.21,825.33 1791.51,783.928 1793.82,830.279 1796.13,778.14 1798.44,931.607 1800.75,925.665 1803.05,775.236 1805.36,1004.15 1807.67,933.849 1809.98,1065.09 1812.28,878.405 1814.59,947.596 1816.9,1059.06 1819.21,987.262 1821.52,818.054 1823.82,877.683 1826.13,989.283 1828.44,890.389 1830.75,1059.35 1833.06,940.509 1835.36,1050.98 1837.67,1055.75 1839.98,1178.96 1842.29,783.526 1844.6,892.951 1846.9,927.992 1849.21,954.951 1851.52,928.677 1853.83,920.043 1856.14,883.332 1858.44,963.643 1860.75,942.15 1863.06,922.144 1865.37,1101.67 1867.67,1002.19 1869.98,808.095 1872.29,917.926 1874.6,1078.87 1876.91,950.339 1879.21,942.886 1881.52,908.394 1883.83,1105.85 1886.14,808.589 1888.45,920.89 1890.75,1130.13 1893.06,970.162 1895.37,796.642 1897.68,877.713 1899.99,647.606 1902.29,859.004 1904.6,891.389 1906.91,774.115 1909.22,944.772 1911.53,818.515 1913.83,939.725 1916.14,871.003 1918.45,801.74 1920.76,885.068 1923.06,753.542 1925.37,855.507 1927.68,780.908 1929.99,692.717 1932.3,866.66 1934.6,946.844 1936.91,736.131 1939.22,1017.3 1941.53,726.343 1943.84,974.78 1946.14,916.403 1948.45,861.756 1950.76,726.163 1953.07,888.932 1955.38,712.138 1957.68,831.393 1959.99,806.011 1962.3,869.097 1964.61,696.921 1966.91,804.96 1969.22,870.821 1971.53,799.835 1973.84,861.363 1976.15,850.621 1978.45,939.27 1980.76,838.636 1983.07,820.003 1985.38,929.421 1987.69,805.033 1989.99,883.273 1992.3,1059.34 1994.61,822.307 1996.92,750.652 1999.23,818.188 2001.53,1051.08 2003.84,852.454 2006.15,814.391 2008.46,811.384 2010.77,1050.53 2013.07,1082.23 2015.38,876.319 2017.69,891.965 2020,1026.51 2022.3,822.862 2024.61,754.761 2026.92,779.579 2029.23,674.09 2031.54,818.487 2033.84,816.464 2036.15,897.228 2038.46,878.339 2040.77,913.546 2043.08,722.378 2045.38,988.366 2047.69,890.465 2050,731.489 2052.31,829.471 2054.62,842.291 2056.92,956.61 2059.23,968.432 2061.54,864.269 2063.85,656.552 2066.16,699.865 2068.46,731.577 2070.77,710.965 2073.08,849.734 2075.39,838.023 2077.69,789.037 2080,939.052 2082.31,863.561 2084.62,919.066 2086.93,747.948 2089.23,853.763 2091.54,981.306 2093.85,908.976 2096.16,817.617 2098.47,762.612 2100.77,920.293 2103.08,778.778 2105.39,976.846 2107.7,814.909 2110.01,675.178 2112.31,996.552 2114.62,924.145 2116.93,1029.28 2119.24,898.574 2121.55,1100.78 2123.85,984.681 2126.16,961.476 2128.47,788.385 2130.78,874.455 2133.08,1195.69 2135.39,810.086 2137.7,1131.32 2140.01,849.621 2142.32,785.465 2144.62,815.298 2146.93,821.757 2149.24,852.905 2151.55,846.212 2153.86,842.745 2156.16,874.507 2158.47,879.266 2160.78,1006.48 2163.09,700.299 2165.4,866.606 2167.7,785.203 2170.01,773.616 2172.32,843.036 2174.63,913.946 2176.93,788.323 2179.24,658.976 2181.55,826.256 2183.86,884.069 2186.17,825.511 2188.47,894.769 2190.78,973.612 2193.09,800.329 2195.4,913.666 2197.71,873.008 2200.01,866.941 2202.32,850.709 2204.63,864.209 2206.94,807.203 2209.25,855.734 2211.55,1042.65 2213.86,803.368 2216.17,889.203 2218.48,723.168 2220.79,780.063 2223.09,970.661 2225.4,802.419 2227.71,1047.22 2230.02,964.344 2232.32,866.21 2234.63,865.734 2236.94,939.606 2239.25,857.045 2241.56,988.36 2243.86,1028.04 2246.17,836.251 2248.48,899.56 2250.79,778.385 2253.1,867.835 2255.4,770.599 2257.71,862.571 2260.02,824.848 2262.33,929.811 2264.64,792.406 2266.94,922.222 2269.25,935.202 2271.56,889.195 2273.87,975.453 2276.18,946.126 2278.48,864.304 2280.79,812.64 2283.1,804.21 2285.41,1047.58 2287.71,881.652 2290.02,767.503 2292.33,917.537 2294.64,793.344 2296.95,886.972 2299.25,948.128 2301.56,913.913 2303.87,980.128 2306.18,806.383 2308.49,979.025 2310.79,856.663 2313.1,888 2315.41,910.423 2317.72,792.647 2320.03,893.144 2322.33,822.358 2324.64,861.891 2326.95,999.843 2329.26,1008.1 2331.56,961.957 2333.87,775.841 2336.18,843.037 2338.49,914.167 2340.8,999.957 2343.1,825.04 2345.41,1091.91 2347.72,733.874 2350.03,976.892 2352.34,658.645 2354.64,883.906 2356.95,931.936 2359.26,938.729 2361.57,831.004 2363.88,799.763 2366.18,1002.25 2368.49,1017.18 2370.8,988.547 2373.11,898.403 2375.42,838.87 2377.72,789.321 2380.03,900.271 2382.34,934.104 2384.65,759.614 2386.95,812.327 2389.26,969.381 2391.57,775.24 2393.88,983.53 2396.19,722.856 2398.49,865.956 2400.8,931.58 2403.11,816.522 2405.42,712.99 2407.73,936.749 2410.03,921.088 2412.34,814.6 2414.65,883.773 2416.96,965.036 2419.27,882.157 2421.57,937.701 2423.88,867.318 2426.19,796.092 2428.5,838.989 2430.81,767.356 2433.11,921.051 2435.42,971.23 2437.73,983.682 2440.04,854.341 2442.34,960.077 2444.65,689.113 2446.96,715.052 2449.27,892.508 2451.58,760.933 2453.88,913.761 2456.19,764.404 2458.5,912.319 2460.81,900.362 2463.12,812.71 2465.42,740.173 2467.73,783.329 2470.04,819.764 2472.35,931.667 2474.66,959.778 2476.96,855.873 2479.27,815.577 2481.58,934.103 2483.89,964.918 2486.2,832.687 2488.5,871.57 2490.81,753.196 2493.12,754.674 2495.43,919.682 2497.73,846.054 2500.04,869.478 2502.35,1029.93 2504.66,775.567 2506.97,626.909 2509.27,1040.41 2511.58,1072.07 2513.89,902.474 2516.2,889.595 2518.51,824.68 2520.81,815.489 2523.12,819.405 2525.43,868.887 2527.74,688.537 2530.05,906.774 2532.35,738.628 2534.66,857.002 2536.97,891.958 2539.28,900.416 2541.58,771.917 2543.89,974.289 2546.2,900.183 2548.51,796.346 2550.82,1018.14 2553.12,882.525 2555.43,707.261 2557.74,867.178 2560.05,787.885 2562.36,841.6 2564.66,884.665 2566.97,916.846 2569.28,958.682 2571.59,750.832 "></polyline>
<polyline clip-path="url(#clip142)" style="stroke:#3da44d; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:0.5; fill:none" points="265.984,547.963 268.292,359.927 270.6,510.538 272.908,289.098 275.216,244.223 277.524,180.975 279.832,400.378 282.139,370.322 284.447,418.543 286.755,425.055 289.063,245.334 291.371,533.734 293.679,258.129 295.987,360.298 298.295,445.959 300.603,501.897 302.911,336.904 305.219,330.803 307.527,501.328 309.834,535.835 312.142,400.997 314.45,417.14 316.758,357.095 319.066,361.926 321.374,529.993 323.682,447.6 325.99,320.363 328.298,309.087 330.606,324.854 332.914,355.768 335.221,471.643 337.529,435.492 339.837,380.273 342.145,484.195 344.453,319.136 346.761,416.328 349.069,476.181 351.377,319.771 353.685,582.372 355.993,445.698 358.301,104.3 360.608,359.648 362.916,443.112 365.224,239.928 367.532,379.453 369.84,433.743 372.148,306.413 374.456,341.373 376.764,291.558 379.072,350.099 381.38,369.328 383.688,416.195 385.996,340.204 388.303,502.681 390.611,480.95 392.919,418.889 395.227,192.149 397.535,438.743 399.843,560.435 402.151,277.646 404.459,294.319 406.767,404.015 409.075,284.542 411.383,354.466 413.69,372.477 415.998,343.857 418.306,468.357 420.614,420.946 422.922,292.052 425.23,348.989 427.538,411.975 429.846,292.357 432.154,459.416 434.462,299.868 436.77,404.433 439.077,428.178 441.385,433.078 443.693,160.104 446.001,474.66 448.309,402.061 450.617,289.624 452.925,345.856 455.233,415.507 457.541,374.783 459.849,410.23 462.157,355.751 464.465,417.024 466.772,332.279 469.08,384.758 471.388,348.338 473.696,285.159 476.004,316.208 478.312,390.34 480.62,206.148 482.928,262.325 485.236,174.802 487.544,452.053 489.852,389.357 492.159,465.754 494.467,216.785 496.775,222.617 499.083,214.318 501.391,304.061 503.699,338.309 506.007,391.827 508.315,359.435 510.623,351.722 512.931,382.273 515.239,415.143 517.546,333.587 519.854,362.264 522.162,472.42 524.47,216.199 526.778,433.427 529.086,339.929 531.394,521.705 533.702,368.643 536.01,349.388 538.318,461.112 540.626,390.694 542.933,358.839 545.241,389.158 547.549,420.574 549.857,278.175 552.165,472.396 554.473,302.015 556.781,304.098 559.089,312.904 561.397,271.871 563.705,555.632 566.013,346.06 568.321,365.479 570.628,443.958 572.936,377.211 575.244,191.517 577.552,275.996 579.86,387.091 582.168,283.739 584.476,386.575 586.784,278.585 589.092,609.158 591.4,201.834 593.708,264.903 596.015,370.27 598.323,286.318 600.631,264.478 602.939,444.297 605.247,406.318 607.555,402.843 609.863,459.174 612.171,316.701 614.479,421.502 616.787,186.434 619.095,267.917 621.402,482.846 623.71,389.589 626.018,454.325 628.326,217.934 630.634,476.002 632.942,331.915 635.25,401.402 637.558,405.855 639.866,300.751 642.174,407.349 644.482,427.019 646.79,398.573 649.097,341.943 651.405,419.133 653.713,465.127 656.021,191.7 658.329,300.201 660.637,195.958 662.945,216.757 665.253,322.287 667.561,529.663 669.869,306.121 672.177,422.957 674.484,451.667 676.792,308.678 679.1,206.335 681.408,272.995 683.716,306.23 686.024,423.936 688.332,346.887 690.64,381.038 692.948,627.431 695.256,285.675 697.564,507.983 699.871,366.14 702.179,383.451 704.487,496.565 706.795,286.391 709.103,449.199 711.411,461.183 713.719,360.775 716.027,453.514 718.335,420.843 720.643,462.827 722.951,299.574 725.259,158.412 727.566,427.738 729.874,436.493 732.182,458.631 734.49,487.418 736.798,356.257 739.106,322.971 741.414,469.017 743.722,434.174 746.03,429.622 748.338,275.653 750.646,301.586 752.953,403.274 755.261,383.003 757.569,356.43 759.877,223.557 762.185,465.91 764.493,337.166 766.801,262.542 769.109,361.881 771.417,498.5 773.725,357.515 776.033,532.667 778.34,490.478 780.648,228.927 782.956,511.226 785.264,367.261 787.572,417.497 789.88,348.35 792.188,457.644 794.496,474.047 796.804,520.845 799.112,225.192 801.42,542.957 803.728,341.618 806.035,447.509 808.343,474.802 810.651,188.159 812.959,448.691 815.267,454.46 817.575,310.185 819.883,302.271 822.191,534.066 824.499,505.629 826.807,239.153 829.115,356.709 831.422,442.735 833.73,428.46 836.038,428.735 838.346,430.258 840.654,429.401 842.962,318.971 845.27,407.275 847.578,572.857 849.886,313.361 852.194,382.255 854.502,348.711 856.809,372.475 859.117,374.28 861.425,179.869 863.733,219.384 866.041,206.518 868.349,356.744 870.657,478.113 872.965,363.397 875.273,321.594 877.581,184.544 879.889,365.247 882.197,378.645 884.504,529.276 886.812,394.07 889.12,414.774 891.428,212.418 893.736,430.177 896.044,429.291 898.352,260.086 900.66,394.707 902.968,380.408 905.276,315.019 907.584,466.718 909.891,461.972 912.199,374.352 914.507,313.474 916.815,407.889 919.123,395.721 921.431,250.593 923.739,416.582 926.047,327.812 928.355,591.373 930.663,230.352 932.971,330.66 935.278,328.531 937.586,482.116 939.894,371.283 942.202,463.732 944.51,338.146 946.818,507.083 949.126,200.852 951.434,597.528 953.742,356.766 956.05,351.736 958.358,206.8 960.665,191.212 962.973,453.45 965.281,515.965 967.589,385.727 969.897,497.827 972.205,531.05 974.513,560.247 976.821,457.32 979.129,500.417 981.437,505.753 983.745,447.155 986.053,432.51 988.36,284.925 990.668,452.699 992.976,96.8724 995.284,491.34 997.592,316.62 999.9,534.694 1002.21,376.365 1004.52,384.894 1006.82,267.817 1009.13,424.597 1011.44,396.463 1013.75,456.883 1016.06,346.615 1018.36,487.24 1020.67,390.084 1022.98,307.355 1025.29,273.555 1027.59,363.751 1029.9,196.387 1032.21,322.735 1034.52,428.449 1036.83,327.567 1039.13,359.946 1041.44,260.923 1043.75,353.397 1046.06,338.879 1048.37,487.534 1050.67,276.322 1052.98,381.743 1055.29,229.479 1057.6,416.085 1059.91,176.796 1062.21,410.095 1064.52,401.035 1066.83,472.951 1069.14,358.682 1071.45,240.568 1073.75,307.321 1076.06,425.043 1078.37,398.537 1080.68,352.198 1082.98,408.883 1085.29,416.488 1087.6,479.696 1089.91,507.854 1092.22,269.658 1094.52,235.757 1096.83,325.084 1099.14,426.069 1101.45,255.152 1103.76,333.752 1106.06,325.966 1108.37,372.151 1110.68,272.065 1112.99,472.004 1115.3,540.719 1117.6,281.86 1119.91,394.559 1122.22,364.439 1124.53,315.918 1126.84,422.403 1129.14,330.769 1131.45,464.217 1133.76,433.219 1136.07,417.928 1138.37,282.489 1140.68,637.543 1142.99,257.415 1145.3,431.141 1147.61,438.12 1149.91,599.918 1152.22,418.221 1154.53,630.232 1156.84,291.009 1159.15,293.995 1161.45,563.74 1163.76,471.071 1166.07,375.383 1168.38,448.01 1170.69,419.799 1172.99,327.358 1175.3,398.706 1177.61,165.131 1179.92,235.19 1182.23,341.724 1184.53,365.349 1186.84,401.963 1189.15,345.277 1191.46,355.089 1193.76,332.411 1196.07,514.84 1198.38,382.418 1200.69,299.439 1203,423.917 1205.3,503.683 1207.61,419.085 1209.92,250.052 1212.23,212.25 1214.54,363.85 1216.84,242.194 1219.15,490.126 1221.46,334.644 1223.77,252.03 1226.08,411.16 1228.38,359.003 1230.69,227.907 1233,439.906 1235.31,441.722 1237.61,415.456 1239.92,265.514 1242.23,345.266 1244.54,309.247 1246.85,468.905 1249.15,211.302 1251.46,581.401 1253.77,358.702 1256.08,429.519 1258.39,319.259 1260.69,449.752 1263,478.164 1265.31,307.486 1267.62,277.45 1269.93,299.548 1272.23,405.404 1274.54,238.076 1276.85,404.885 1279.16,392.927 1281.47,193.238 1283.77,332.228 1286.08,568.023 1288.39,431.024 1290.7,388.898 1293,407.5 1295.31,442.919 1297.62,421.164 1299.93,201.71 1302.24,376.777 1304.54,174.89 1306.85,203.245 1309.16,297.111 1311.47,342.17 1313.78,431.086 1316.08,274.192 1318.39,508.327 1320.7,473.283 1323.01,214.672 1325.32,419.942 1327.62,347.574 1329.93,336.238 1332.24,539.771 1334.55,377.77 1336.86,182.19 1339.16,420.595 1341.47,521.35 1343.78,394.107 1346.09,458.622 1348.39,315.308 1350.7,221.362 1353.01,510.447 1355.32,243.997 1357.63,512.657 1359.93,288.207 1362.24,367.195 1364.55,460.143 1366.86,341.667 1369.17,354.519 1371.47,450.754 1373.78,207.329 1376.09,311.985 1378.4,234.211 1380.71,371.067 1383.01,553.368 1385.32,426.848 1387.63,474.246 1389.94,308.995 1392.24,293.731 1394.55,516.232 1396.86,464.045 1399.17,498.569 1401.48,382.847 1403.78,370.746 1406.09,362.633 1408.4,493.074 1410.71,380.847 1413.02,529.888 1415.32,304.78 1417.63,495.927 1419.94,575.036 1422.25,410.657 1424.56,422.894 1426.86,339.205 1429.17,198.227 1431.48,312.607 1433.79,514.425 1436.1,413.133 1438.4,448.202 1440.71,475.677 1443.02,328.256 1445.33,537.873 1447.63,415.743 1449.94,446.848 1452.25,168.605 1454.56,379.271 1456.87,261.332 1459.17,441.186 1461.48,344.188 1463.79,409.341 1466.1,535.239 1468.41,426.318 1470.71,458.368 1473.02,216.384 1475.33,330.979 1477.64,326.286 1479.95,395.977 1482.25,442.523 1484.56,387.148 1486.87,399.473 1489.18,501.554 1491.49,331.984 1493.79,485.731 1496.1,343.757 1498.41,311.364 1500.72,499.401 1503.02,420.866 1505.33,369.024 1507.64,139.675 1509.95,378.426 1512.26,632.439 1514.56,433.967 1516.87,360.138 1519.18,308.522 1521.49,366.574 1523.8,431.262 1526.1,345.128 1528.41,456.754 1530.72,509.137 1533.03,486.766 1535.34,302.441 1537.64,462.928 1539.95,469.324 1542.26,393.574 1544.57,215.119 1546.88,438.007 1549.18,466.934 1551.49,255.716 1553.8,314.569 1556.11,506.249 1558.41,389.09 1560.72,398.213 1563.03,305.928 1565.34,285.976 1567.65,427.04 1569.95,364.814 1572.26,190.459 1574.57,444.869 1576.88,404.667 1579.19,368.343 1581.49,353.704 1583.8,353.378 1586.11,394.614 1588.42,428.651 1590.73,459.028 1593.03,539.774 1595.34,474.372 1597.65,412.152 1599.96,292.36 1602.26,351.62 1604.57,381.013 1606.88,425.13 1609.19,170.748 1611.5,353.635 1613.8,301.957 1616.11,301.601 1618.42,339.175 1620.73,298.427 1623.04,454.637 1625.34,417.787 1627.65,437.023 1629.96,378.746 1632.27,384.009 1634.58,403.661 1636.88,417.597 1639.19,270.072 1641.5,331.433 1643.81,439.39 1646.12,301.025 1648.42,315.615 1650.73,341.905 1653.04,433.659 1655.35,476.65 1657.65,364.125 1659.96,423.77 1662.27,311.478 1664.58,370.026 1666.89,187.075 1669.19,459.487 1671.5,413.96 1673.81,457.57 1676.12,515.902 1678.43,547.292 1680.73,384.316 1683.04,407.584 1685.35,368.729 1687.66,442.708 1689.97,471.811 1692.27,452.892 1694.58,495.85 1696.89,477.945 1699.2,406.51 1701.51,358.803 1703.81,424.311 1706.12,436.822 1708.43,307.381 1710.74,366.101 1713.04,292.855 1715.35,313.007 1717.66,361.723 1719.97,286.576 1722.28,379.601 1724.58,468.915 1726.89,307.44 1729.2,253.33 1731.51,310.805 1733.82,310.817 1736.12,410.386 1738.43,447.93 1740.74,420.007 1743.05,492.041 1745.36,251.08 1747.66,313.774 1749.97,275.016 1752.28,476.904 1754.59,325.139 1756.9,442.092 1759.2,575.921 1761.51,339.925 1763.82,462.442 1766.13,494.245 1768.43,280.72 1770.74,470.909 1773.05,403.349 1775.36,444.993 1777.67,458.183 1779.97,440.327 1782.28,318.566 1784.59,396.892 1786.9,416.476 1789.21,481.06 1791.51,399.45 1793.82,191.495 1796.13,248.872 1798.44,440.759 1800.75,355.796 1803.05,404.632 1805.36,448.074 1807.67,463.366 1809.98,366.575 1812.28,458.322 1814.59,283.666 1816.9,443.67 1819.21,503.411 1821.52,475.989 1823.82,443.811 1826.13,264.493 1828.44,478.083 1830.75,359.337 1833.06,421.512 1835.36,324.392 1837.67,351.515 1839.98,358.271 1842.29,238.663 1844.6,417.851 1846.9,290.622 1849.21,385.279 1851.52,489.317 1853.83,301.966 1856.14,376.495 1858.44,452.441 1860.75,339.17 1863.06,598.158 1865.37,468.73 1867.67,136.165 1869.98,290.282 1872.29,373.519 1874.6,312.997 1876.91,506.569 1879.21,377.253 1881.52,365.827 1883.83,138.592 1886.14,428.438 1888.45,315.978 1890.75,265.04 1893.06,533.069 1895.37,511.233 1897.68,418.251 1899.99,619.672 1902.29,296.24 1904.6,371.62 1906.91,185.851 1909.22,410.346 1911.53,281.975 1913.83,564.589 1916.14,203.236 1918.45,397.502 1920.76,406.982 1923.06,511.503 1925.37,430.277 1927.68,304.516 1929.99,392.217 1932.3,299.759 1934.6,517.451 1936.91,462.389 1939.22,334.555 1941.53,322.948 1943.84,354.688 1946.14,328.257 1948.45,441.026 1950.76,405.557 1953.07,304.617 1955.38,396.723 1957.68,242.369 1959.99,313.091 1962.3,396.973 1964.61,406.134 1966.91,370.323 1969.22,304.727 1971.53,318.177 1973.84,474.198 1976.15,348.934 1978.45,353.596 1980.76,380.208 1983.07,316.904 1985.38,406.798 1987.69,500.189 1989.99,462.108 1992.3,479.195 1994.61,230.399 1996.92,352.065 1999.23,449.933 2001.53,501.546 2003.84,355.952 2006.15,357.076 2008.46,376.982 2010.77,407.954 2013.07,450.803 2015.38,354.99 2017.69,491.035 2020,425.696 2022.3,465.717 2024.61,380.091 2026.92,552.219 2029.23,471.181 2031.54,289.948 2033.84,299.821 2036.15,339.393 2038.46,551.153 2040.77,471.769 2043.08,316.817 2045.38,137.606 2047.69,257.377 2050,357.33 2052.31,401.287 2054.62,315.352 2056.92,307.862 2059.23,346.402 2061.54,219.01 2063.85,419.287 2066.16,456.381 2068.46,485.856 2070.77,439.244 2073.08,249.957 2075.39,341.137 2077.69,363.341 2080,540.84 2082.31,299.45 2084.62,393.368 2086.93,437.83 2089.23,414.674 2091.54,418.517 2093.85,371.969 2096.16,289.903 2098.47,344.81 2100.77,247.781 2103.08,556.342 2105.39,390.078 2107.7,197.594 2110.01,374.604 2112.31,466.593 2114.62,454.739 2116.93,428.114 2119.24,494.442 2121.55,319.551 2123.85,313.519 2126.16,369.165 2128.47,364.073 2130.78,387.617 2133.08,278.665 2135.39,376.186 2137.7,438.035 2140.01,342.941 2142.32,248.472 2144.62,514.64 2146.93,380.511 2149.24,482.337 2151.55,351.761 2153.86,373.579 2156.16,476.667 2158.47,414.311 2160.78,366.042 2163.09,412.062 2165.4,229.966 2167.7,316.501 2170.01,266.67 2172.32,243.251 2174.63,417.278 2176.93,442.733 2179.24,556.208 2181.55,286.366 2183.86,300.687 2186.17,451.429 2188.47,370.207 2190.78,296.634 2193.09,362.543 2195.4,360.581 2197.71,636.94 2200.01,508.208 2202.32,319.121 2204.63,349.209 2206.94,335.659 2209.25,349.267 2211.55,250.508 2213.86,401.755 2216.17,173.021 2218.48,336.616 2220.79,409.222 2223.09,404.737 2225.4,420.581 2227.71,332.818 2230.02,605.26 2232.32,294.589 2234.63,289.087 2236.94,369.265 2239.25,280.884 2241.56,332.082 2243.86,303.643 2246.17,468.531 2248.48,556.631 2250.79,436.693 2253.1,283.065 2255.4,341.935 2257.71,477.453 2260.02,363.91 2262.33,495.379 2264.64,356.544 2266.94,394.344 2269.25,473.974 2271.56,619.599 2273.87,499.868 2276.18,255.367 2278.48,368.392 2280.79,301.235 2283.1,377.064 2285.41,462.712 2287.71,348.065 2290.02,233.791 2292.33,494.738 2294.64,454.894 2296.95,333.866 2299.25,247.013 2301.56,485.037 2303.87,476.09 2306.18,375.033 2308.49,308.967 2310.79,353.398 2313.1,288.277 2315.41,305.635 2317.72,552.832 2320.03,524.784 2322.33,414.523 2324.64,308.672 2326.95,516.494 2329.26,475.048 2331.56,371.014 2333.87,413.755 2336.18,210.682 2338.49,438.822 2340.8,458.969 2343.1,349.067 2345.41,195.327 2347.72,416.059 2350.03,537.943 2352.34,307.924 2354.64,354.322 2356.95,407.665 2359.26,413.046 2361.57,258.363 2363.88,371.128 2366.18,295.354 2368.49,496.042 2370.8,397.411 2373.11,316.522 2375.42,420.964 2377.72,384.62 2380.03,262.474 2382.34,428.392 2384.65,243.386 2386.95,368.827 2389.26,382.989 2391.57,461.59 2393.88,422.259 2396.19,295.522 2398.49,443.841 2400.8,392.638 2403.11,324.734 2405.42,400.966 2407.73,425.575 2410.03,213.939 2412.34,307.841 2414.65,458.167 2416.96,328.937 2419.27,444.767 2421.57,280.751 2423.88,260.78 2426.19,337.235 2428.5,366.689 2430.81,382.234 2433.11,307.457 2435.42,517.822 2437.73,440.912 2440.04,503.312 2442.34,376.587 2444.65,364.084 2446.96,493.017 2449.27,366.061 2451.58,407.934 2453.88,430.533 2456.19,335.212 2458.5,336.949 2460.81,316.987 2463.12,377.168 2465.42,362.762 2467.73,279.669 2470.04,308.666 2472.35,451.794 2474.66,431.909 2476.96,455.625 2479.27,289.469 2481.58,155.963 2483.89,378.637 2486.2,295.73 2488.5,526.725 2490.81,260.241 2493.12,168.273 2495.43,275.609 2497.73,326.586 2500.04,500.552 2502.35,421.321 2504.66,375.329 2506.97,292.181 2509.27,238.398 2511.58,439.487 2513.89,247.492 2516.2,282.369 2518.51,517.847 2520.81,424.681 2523.12,496.413 2525.43,313.869 2527.74,358.041 2530.05,309.621 2532.35,444.164 2534.66,366.343 2536.97,497.503 2539.28,556.433 2541.58,292.807 2543.89,446.581 2546.2,435.395 2548.51,582.589 2550.82,306.522 2553.12,498.991 2555.43,450.629 2557.74,366.966 2560.05,281.616 2562.36,376.361 2564.66,412.388 2566.97,301.918 2569.28,477.977 2571.59,343.217 "></polyline>
</svg>
</div>
</div>
<p>Look at that! Things are working; amazin’.</p>
<p>We can also exploit <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a>’s parallel sampling capabilities:</p>
<div id="34" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run separate 4 chains for 10 000 iterations using threads to parallelize.</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>num_chains <span class="op">=</span> <span class="fl">4</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    model_with_grad,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    sampler,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MCMCThreads</span>(),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="fl">10_000</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    num_chains;</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Note we need to provide an initial state for every chain.</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    initial_state<span class="op">=</span><span class="fu">fill</span>(state, num_chains),</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    progress<span class="op">=</span><span class="cn">false</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>samples_array <span class="op">=</span> <span class="fu">stack</span>(<span class="fu">map</span>(<span class="bu">Base</span>.<span class="fu">Fix1</span>(stack, sample <span class="op">-&gt;</span> sample.x), samples))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×10000×4 Array{Float64, 3}:
[:, :, 1] =
 -2.63911    -2.93601   -2.17019   …  -4.41878   -4.66234    -4.17865
  0.0251873  -0.875797  -0.227578     -0.716241  -0.0651509  -0.485009
  2.65399     3.05441    4.03715       3.88375    4.35884     4.95589

[:, :, 2] =
 -3.51636  -6.28525   -6.28525   -5.68861   …  -5.33631  -5.56585   -5.56585
 -1.16232  -0.515198  -0.515198   0.982152      1.02853   0.397088   0.397088
  2.95704   5.45192    5.45192    5.01038       6.47403   6.73891    6.73891

[:, :, 3] =
 -2.64122  -2.52638   -5.84967  -5.035     …  -7.10638   -6.56587   -6.22083
  1.66568  -0.349574  -1.33044   0.116984     -0.303946  -0.412179   0.108416
  2.07817   3.69617    4.17425   4.22651       5.22733    5.26386    4.51016

[:, :, 4] =
 -2.27186   -2.65454  -5.21372  -4.12875   …  -5.37479  -3.13787  -4.11422
 -0.797761  -1.87446  -1.15802  -0.863082      1.0519    1.61625  -0.371919
  4.18407    1.15325   1.97691   3.42292       5.06068   5.52475   6.54885</code></pre>
</div>
</div>
<p>But the fact that we have to provide the <code>AbstractMCMC.sample</code> call, etc. with an <code>initial_state</code> to get started is a bit annoying. We can avoid this by also defining a <code>AbstractMCMC.step</code> <em>without</em> the <code>state</code> argument:</p>
<div id="36" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> AbstractMCMC.<span class="fu">step</span>(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    rng<span class="op">::</span><span class="dt">Random.AbstractRNG</span>,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    model_wrapper<span class="op">::</span><span class="dt">AbstractMCMC.LogDensityModel</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">::</span><span class="dt">MALA</span>;</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># </span><span class="al">NOTE</span><span class="co">: No state provided!</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    kwargs<span class="op">...</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> model_wrapper.logdensity</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Let's just create the initial state by sampling using  a Gaussian.</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="fu">randn</span>(rng, LogDensityProblems.<span class="fu">dimension</span>(model))</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">MALASample</span>(x), <span class="fu">MALAState</span>(x)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Equipped with this, we no longer need to provide the <code>initial_state</code> everywhere:</p>
<div id="38" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> <span class="fu">sample</span>(model_with_grad, sampler, <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>samples_matrix <span class="op">=</span> <span class="fu">stack</span>(sample <span class="op">-&gt;</span> sample.x, samples)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hcat</span>(<span class="fu">mean</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>), <span class="fu">std</span>(samples_matrix; dims<span class="op">=</span><span class="fl">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3×2 Matrix{Float64}:
 -5.00117    1.0156
 -0.0340319  1.00764
  5.00121    0.990736</code></pre>
</div>
</div>
</section>
<section id="using-our-sampler-with-turing.jl" class="level2">
<h2 class="anchored" data-anchor-id="using-our-sampler-with-turing.jl">Using our sampler with Turing.jl</h2>
<p>As we promised, all of this hassle of implementing our <code>MALA</code> sampler in a way that uses <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> and <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> gets us something more than <em>just</em> an “automatic” implementation of <code>AbstractMCMC.sample</code>.</p>
<p>It also enables use with Turing.jl through the <code>externalsampler</code>, but we need to do one final thing first: we need to tell Turing.jl how to extract a vector of parameters from the “sample” returned in our implementation of <code>AbstractMCMC.step</code>. In our case, the “sample” is a <code>MALASample</code>, so we just need the following line:</p>
<div id="40" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Turing.jl.</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Turing</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Overload the `getparams` method for our "sample" type, which is just a vector.</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>Turing.Inference.<span class="fu">getparams</span>(<span class="op">::</span><span class="dt">Turing.Model</span>, sample<span class="op">::</span><span class="dt">MALASample</span>) <span class="op">=</span> sample.x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And with that, we’re good to go!</p>
<div id="42" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Our previous model defined as a Turing.jl model.</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="fu">mvnormal_model</span>() <span class="op">=</span> x <span class="op">~</span> <span class="fu">MvNormal</span>([<span class="op">-</span><span class="fl">5</span>., <span class="fl">0</span>., <span class="fl">5</span>.], I)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Instantiate our model.</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>turing_model <span class="op">=</span> <span class="fu">mvnormal_model</span>()</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Call `sample` but now we're passing in a Turing.jl `model` and wrapping</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co"># our `MALA` sampler in the `externalsampler` to tell Turing.jl that the sampler</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co"># expects something that implements LogDensityProblems.jl.</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×4×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 2.85 seconds
Compute duration  = 2.85 seconds
parameters        = x[1], x[2], x[3]
internals         = lp

Summary Statistics
  parameters      mean       std      mcse    ess_bulk    ess_tail      rhat   ⋯
      Symbol   Float64   Float64   Float64     Float64     Float64   Float64   ⋯

        x[1]   -5.0090    1.0044    0.0176   3243.3108   5090.9237    1.0004   ⋯
        x[2]    0.0297    1.0086    0.0182   3057.4966   5396.5251    0.9999   ⋯
        x[3]    5.0072    1.0093    0.0181   3104.4115   5102.8741    1.0000   ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

        x[1]   -6.9639   -5.6762   -5.0125   -4.3513   -3.0561
        x[2]   -1.9173   -0.6616    0.0425    0.7099    1.9732
        x[3]    3.0225    4.3244    5.0014    5.6804    6.9738</code></pre>
</div>
</div>
<p>Pretty neat, eh?</p>
<section id="models-with-constrained-parameters" class="level3">
<h3 class="anchored" data-anchor-id="models-with-constrained-parameters">Models with constrained parameters</h3>
<p>One thing we’ve sort of glossed over in all of the above is that MALA, at least how we’ve implemented it, requires <span class="math inline">\(x\)</span> to live in <span class="math inline">\(\mathbb{R}^d\)</span> for some <span class="math inline">\(d &gt; 0\)</span>. If some of the parameters were in fact constrained, e.g.&nbsp;we were working with a <code>Beta</code> distribution which has support on the interval <span class="math inline">\((0, 1)\)</span>, <em>not</em> on <span class="math inline">\(\mathbb{R}^d\)</span>, we could easily end up outside of the valid range <span class="math inline">\((0, 1)\)</span>.</p>
<div id="44" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="fu">beta_model</span>() <span class="op">=</span> x <span class="op">~</span> <span class="fu">Beta</span>(<span class="fl">3</span>, <span class="fl">3</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>turing_model <span class="op">=</span> <span class="fu">beta_model</span>()</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×2×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 1.64 seconds
Compute duration  = 1.64 seconds
parameters        = x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse    ess_bulk    ess_tail      rhat   ⋯
      Symbol   Float64   Float64   Float64     Float64     Float64   Float64   ⋯

           x    0.4988    0.1899    0.0028   4586.5325   5619.0233    1.0000   ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

           x    0.1434    0.3565    0.5002    0.6379    0.8561</code></pre>
</div>
</div>
<p>Yep, that still works, but only because Turing.jl actually <em>transforms</em> the <code>turing_model</code> from constrained to unconstrained, so that the <code>sampler</code> provided to <code>externalsampler</code> is actually always working in unconstrained space! This is not always desirable, so we can turn this off:</p>
<div id="46" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>chain <span class="op">=</span> <span class="fu">sample</span>(turing_model, <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">false</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×2×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 0.25 seconds
Compute duration  = 0.25 seconds
parameters        = x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

           x    0.0671    0.0000    0.0000        NaN        NaN       NaN     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

           x    0.0671    0.0671    0.0671    0.0671    0.0671</code></pre>
</div>
</div>
<p>The fun thing is that this still sort of works because</p>
<div id="48" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">logpdf</span>(<span class="fu">Beta</span>(<span class="fl">3</span>, <span class="fl">3</span>), <span class="fl">10.0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>-Inf</code></pre>
</div>
</div>
<p>and so the samples that fall outside of the range are always rejected. But do notice how much worse all the diagnostics are, e.g.&nbsp;<code>ess_tail</code> is very poor compared to when we use <code>unconstrained=true</code>. Moreover, in more complex cases this won’t just result in a “nice” <code>-Inf</code> log-density value, but instead will error:</p>
<div id="50" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@model</span> <span class="kw">function</span> <span class="fu">demo</span>()</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    σ² <span class="op">~</span> <span class="fu">truncated</span>(<span class="fu">Normal</span>(), lower<span class="op">=</span><span class="fl">0</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If we end up with negative values for `σ²`, the `Normal` will error.</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    x <span class="op">~</span> <span class="fu">Normal</span>(<span class="fl">0</span>, σ²)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">demo</span>(), <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">false</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>DomainError: DomainError(Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}}(-0.6283728293066848,1.0,0.0), "Normal: the condition σ &gt;= zero(σ) is not satisfied.")
DomainError with Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}}(-0.6283728293066848,1.0,0.0):
Normal: the condition σ &gt;= zero(σ) is not satisfied.
Stacktrace:
  [1] #371
    @ ~/.julia/packages/Distributions/uuqsE/src/univariate/continuous/normal.jl:37 [inlined]
  [2] check_args
    @ ~/.julia/packages/Distributions/uuqsE/src/utils.jl:89 [inlined]
  [3] #Normal#370
    @ ~/.julia/packages/Distributions/uuqsE/src/univariate/continuous/normal.jl:37 [inlined]
  [4] Normal
    @ ~/.julia/packages/Distributions/uuqsE/src/univariate/continuous/normal.jl:36 [inlined]
  [5] Normal
    @ ~/.julia/packages/Distributions/uuqsE/src/univariate/continuous/normal.jl:42 [inlined]
  [6] macro expansion
    @ ~/.julia/packages/DynamicPPL/DvdZw/src/compiler.jl:579 [inlined]
  [7] demo(__model__::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, __varinfo__::DynamicPPL.ThreadSafeVarInfo{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, Vector{Set{DynamicPPL.Selector}}}}, ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, Vector{Base.RefValue{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}, __context__::DynamicPPL.DefaultContext)
    @ Main.Notebook ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:593
  [8] _evaluate!!
    @ ~/.julia/packages/DynamicPPL/DvdZw/src/model.jl:973 [inlined]
  [9] evaluate_threadsafe!!(model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, varinfo::DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, Vector{Set{DynamicPPL.Selector}}}}, ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}, context::DynamicPPL.DefaultContext)
    @ DynamicPPL ~/.julia/packages/DynamicPPL/DvdZw/src/model.jl:962
 [10] evaluate!!
    @ ~/.julia/packages/DynamicPPL/DvdZw/src/model.jl:892 [inlined]
 [11] logdensity
    @ ~/.julia/packages/DynamicPPL/DvdZw/src/logdensityfunction.jl:140 [inlined]
 [12] Fix1
    @ ./operators.jl:1118 [inlined]
 [13] vector_mode_dual_eval!(f::Base.Fix1{typeof(LogDensityProblems.logdensity), LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}}, cfg::ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}, x::Vector{Float64})
    @ ForwardDiff ~/.julia/packages/ForwardDiff/PcZ48/src/apiutils.jl:24
 [14] vector_mode_gradient!(result::DiffResults.MutableDiffResult{1, Float64, Tuple{Vector{Float64}}}, f::Base.Fix1{typeof(LogDensityProblems.logdensity), LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}}, x::Vector{Float64}, cfg::ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}})
    @ ForwardDiff ~/.julia/packages/ForwardDiff/PcZ48/src/gradient.jl:96
 [15] gradient!
    @ ~/.julia/packages/ForwardDiff/PcZ48/src/gradient.jl:37 [inlined]
 [16] gradient!
    @ ~/.julia/packages/ForwardDiff/PcZ48/src/gradient.jl:35 [inlined]
 [17] logdensity_and_gradient
    @ ~/.julia/packages/LogDensityProblemsAD/CvDZt/ext/LogDensityProblemsADForwardDiffExt.jl:116 [inlined]
 [18] leapfrog_step(model::LogDensityProblemsADForwardDiffExt.ForwardDiffLogDensity{LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}, ForwardDiff.Chunk{2}, ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}, x::Vector{Float64}, p::Vector{Float64}, ϵ::Int64, M::UniformScaling{Bool})
    @ Main.Notebook ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:369
 [19] step(rng::TaskLocalRNG, model_wrapper::AbstractMCMC.LogDensityModel{LogDensityProblemsADForwardDiffExt.ForwardDiffLogDensity{LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}, ForwardDiff.Chunk{2}, ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}}, sampler::MALA{Int64, UniformScaling{Bool}}, state::MALAState{Vector{Float64}}; kwargs::@Kwargs{})
    @ Main.Notebook ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:334
 [20] step
    @ ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:316 [inlined]
 [21] #step#107
    @ ~/.julia/packages/Turing/QN7BL/src/mcmc/abstractmcmc.jl:161 [inlined]
 [22] step(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler_wrapper::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, state::Turing.Inference.TuringState{MALAState{Vector{Float64}}, LogDensityProblemsADForwardDiffExt.ForwardDiffLogDensity{LogDensityFunction{DynamicPPL.TypedVarInfo{@NamedTuple{σ²::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:σ², typeof(identity)}, Int64}, Vector{Truncated{Normal{Float64}, Continuous, Float64, Float64, Nothing}}, Vector{AbstractPPL.VarName{:σ², typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}, x::DynamicPPL.Metadata{Dict{AbstractPPL.VarName{:x, typeof(identity)}, Int64}, Vector{Normal{Float64}}, Vector{AbstractPPL.VarName{:x, typeof(identity)}}, Vector{Float64}, Vector{Set{DynamicPPL.Selector}}}}, Float64}, DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, Nothing}, ForwardDiff.Chunk{2}, ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, ForwardDiff.GradientConfig{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2, Vector{ForwardDiff.Dual{ForwardDiff.Tag{DynamicPPL.DynamicPPLTag, Float64}, Float64, 2}}}}})
    @ Turing.Inference ~/.julia/packages/Turing/QN7BL/src/mcmc/abstractmcmc.jl:150
 [23] macro expansion
    @ ~/.julia/packages/AbstractMCMC/z1nwm/src/sample.jl:217 [inlined]
 [24] macro expansion
    @ ~/.julia/packages/AbstractMCMC/z1nwm/src/logging.jl:16 [inlined]
 [25] mcmcsample(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, N::Int64; progress::Bool, progressname::String, callback::Nothing, num_warmup::Int64, discard_initial::Int64, thinning::Int64, chain_type::Type, initial_state::Nothing, kwargs::@Kwargs{})
    @ AbstractMCMC ~/.julia/packages/AbstractMCMC/z1nwm/src/sample.jl:142
 [26] sample(rng::TaskLocalRNG, model::DynamicPPL.Model{typeof(demo), (), (), (), Tuple{}, Tuple{}, DynamicPPL.DefaultContext}, sampler::DynamicPPL.Sampler{Turing.Inference.ExternalSampler{MALA{Int64, UniformScaling{Bool}}, AutoForwardDiff{nothing, Nothing}, false}}, N::Int64; chain_type::Type, resume_from::Nothing, initial_state::Nothing, kwargs::@Kwargs{progress::Bool})
    @ DynamicPPL ~/.julia/packages/DynamicPPL/DvdZw/src/sampler.jl:93
 [27] sample
    @ ~/.julia/packages/DynamicPPL/DvdZw/src/sampler.jl:83 [inlined]
 [28] #sample#4
    @ ~/.julia/packages/Turing/QN7BL/src/mcmc/Inference.jl:276 [inlined]
 [29] sample
    @ ~/.julia/packages/Turing/QN7BL/src/mcmc/Inference.jl:267 [inlined]
 [30] #sample#3
    @ ~/.julia/packages/Turing/QN7BL/src/mcmc/Inference.jl:264 [inlined]
 [31] top-level scope
    @ ~/work/docs/docs/tutorials/docs-17-implementing-samplers/index.qmd:595</code></pre>
</div>
</div>
<p>As expected, we run into a <code>DomainError</code> at some point, while if we set <code>unconstrained=true</code>, letting Turing.jl transform the model to a unconstrained form behind the scenes, everything works as expected:</p>
<div id="52" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">demo</span>(), <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">true</span>), <span class="fl">10_000</span>; progress<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×3×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 0.56 seconds
Compute duration  = 0.56 seconds
parameters        = σ², x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

          σ²    0.9864    0.7510    0.0889   143.3406    40.5141    1.0082     ⋯
           x   -0.0696    1.1617    0.0976   222.1885   145.0918    1.0000     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

          σ²    0.1145    0.4362    0.8002    1.3250    3.4859
           x   -2.6998   -0.5458   -0.0112    0.3993    2.3508</code></pre>
</div>
</div>
<p>Neat!</p>
<p>Similarly, which automatic differentiation backend one should use can be specified through the <code>adtype</code> keyword argument too. For example, if we want to use <a href="https://github.com/JuliaDiff/ReverseDiff.jl">ReverseDiff.jl</a> instead of the default <a href="https://github.com/JuliaDiff/ForwardDiff.jl">ForwardDiff.jl</a>:</p>
<div id="54" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">ReverseDiff</span>: ReverseDiff</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify that we want to use `AutoReverseDiff`.</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">demo</span>(),</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">externalsampler</span>(sampler; unconstrained<span class="op">=</span><span class="cn">true</span>, adtype<span class="op">=</span><span class="fu">AutoReverseDiff</span>()),</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="fl">10_000</span>;</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    progress<span class="op">=</span><span class="cn">false</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Chains MCMC chain (10000×3×1 Array{Float64, 3}):

Iterations        = 1:1:10000
Number of chains  = 1
Samples per chain = 10000
Wall duration     = 3.16 seconds
Compute duration  = 3.16 seconds
parameters        = σ², x
internals         = lp

Summary Statistics
  parameters      mean       std      mcse   ess_bulk   ess_tail      rhat   e ⋯
      Symbol   Float64   Float64   Float64    Float64    Float64   Float64     ⋯

          σ²    0.8442    0.5666    0.0287   232.2787    53.2484    1.0020     ⋯
           x    0.0521    1.0140    0.0563   464.9024   322.7040    1.0010     ⋯
                                                                1 column omitted

Quantiles
  parameters      2.5%     25.0%     50.0%     75.0%     97.5%
      Symbol   Float64   Float64   Float64   Float64   Float64

          σ²    0.1220    0.4029    0.7207    1.1719    2.2908
           x   -2.0386   -0.3622    0.0312    0.4513    2.3655</code></pre>
</div>
</div>
<p>Double-neat.</p>
</section>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>At this point it’s worth maybe reminding ourselves what we did and also <em>why</em> we did it:</p>
<ol type="1">
<li>We define our models in the <a href="https://github.com/tpapp/LogDensityProblems.jl">LogDensityProblems.jl</a> interface because it makes the sampler agnostic to how the underlying model is implemented.</li>
<li>We implement our sampler in the <a href="https://github.com/TuringLang/AbstractMCMC.jl">AbstractMCMC.jl</a> interface, which just means that our sampler is a subtype of <code>AbstractMCMC.AbstractSampler</code> and we implement the MCMC transition in <code>AbstractMCMC.step</code>.</li>
<li>Points 1 and 2 makes it so our sampler can be used with a wide range of model implementations, amongst them being models implemented in both Turing.jl and Stan. This gives you, the inference implementer, a large collection of models to test your inference method on, in addition to allowing users of Turing.jl and Stan to try out your inference method with minimal effort.</li>
</ol>


</section>


<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>We’re going with the leapfrog formulation because in a future version of this tutorial we’ll add a section extending this simple “baseline” MALA sampler to more complex versions. See <a href="https://github.com/TuringLang/docs/issues/479">issue #479</a> for progress on this.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>There is no such thing as a proper interface in Julia (at least not officially), and so we use the word “interface” here to mean a few minimal methods that needs to be implemented by any type that we treat as a target model.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/turinglang\.org\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../tutorials/docs-07-for-developers-variational-inference/index.html" class="pagination-link" aria-label="Variational Inference">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Variational Inference</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Turing is created by <a href="http://mlg.eng.cam.ac.uk/hong/" target="_blank">Hong Ge</a>, and lovingly maintained by the <a href="https://github.com/TuringLang/Turing.jl/graphs/contributors" target="_blank">core team</a> of volunteers. <br> The contents of this website are © 2024 under the terms of the <a href="https://github.com/TuringLang/Turing.jl/blob/master/LICENCE" target="_blank">MIT License</a>.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/TuringLang/docs/edit/master/tutorials/docs-17-implementing-samplers/index.qmd" target="_blank" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/TuringLang/docs/issues/new" target="_blank" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://x.com/TuringLang">
      <i class="bi bi-twitter" role="img" aria-label="Turing Twitter">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/TuringLang/Turing.jl">
      <i class="bi bi-github" role="img" aria-label="Turing GitHub">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>